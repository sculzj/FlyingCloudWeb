{"ast":null,"code":"import \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nvar _jsxFileName = \"D:\\\\WebStorm Project\\\\flowingcloud\\\\src\\\\pages\\\\System\\\\Login\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { LockOutlined, UserOutlined } from \"@ant-design/icons\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router\";\nimport Store from '../../../redux/store';\nimport RandomCode from \"../../../components/RandomCode\";\nimport systemStyle from \"./index.module.css\";\nimport { Code } from \"../../../resource/constant\";\nimport { saveUserInfo } from \"../../../redux/actions/byUserInfo\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  store\n} = Store;\n\nclass Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: false\n    };\n\n    this.toLogin = () => {\n      if (this.form.getFieldValue('code').toLocaleLowerCase() !== store.getState().code.toLocaleLowerCase()) {\n        _Modal.error({\n          title: '错误',\n          content: '验证码有误，请重新输入！'\n        });\n      } else {\n        const {\n          uid,\n          pwd\n        } = this.form.getFieldsValue();\n        this.setState({\n          loading: true\n        }); //等待15S后超时\n\n        const timer = setTimeout(() => {\n          this.setState({\n            loading: false\n          }, () => {\n            _Modal.error({\n              title: '错误',\n              content: '网络连接超时！请检查您的网络配置，并尝试再次登录。'\n            });\n          });\n        }, 15000);\n        axios({\n          url: 'http://localhost:3000/api/system',\n          method: 'post',\n          data: {\n            uid,\n            pwd\n          }\n        }).then(response => {\n          //清除定时器\n          clearTimeout(timer);\n          console.log(response.data);\n\n          switch (response.data.code) {\n            case Code.error:\n              _Modal.error({\n                title: '错误',\n                content: '登录失败，该账号不存在，请检查登录账号及密码是否正确！'\n              });\n\n              break;\n\n            case Code.success:\n              store.dispatch(saveUserInfo(response.data.userObj));\n              this.props.history.replace('/system/home'); // console.log(store.getState().userInfo);\n\n              break;\n\n            default:\n              break;\n          }\n        }).catch(e => {\n          // console.log(e);\n          _Modal.error({\n            title: '错误',\n            content: e\n          });\n        });\n      }\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: systemStyle.frame,\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: require('../../../images/system_back.jpg').default,\n        className: systemStyle.back,\n        alt: \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: systemStyle.content,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u7CFB\\u7EDF\\u7BA1\\u7406\\u5458\\u767B\\u5F55\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(_Form, {\n          wrapperCol: {\n            span: 24\n          },\n          validateTrigger: \"onBlur\",\n          onFinish: this.toLogin,\n          ref: element => {\n            this.form = element;\n          },\n          className: systemStyle.form,\n          children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n            name: \"uid\",\n            className: systemStyle.item,\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              type: 'string',\n              pattern: /^[A-Za-z0-9]{6,16}$/,\n              message: '账号必须位7~16位字母或数字的组合'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input, {\n              prefix: /*#__PURE__*/_jsxDEV(UserOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 44\n              }, this),\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u767B\\u5F55\\u8D26\\u53F7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            name: \"pwd\",\n            className: systemStyle.item,\n            children: /*#__PURE__*/_jsxDEV(_Input.Password, {\n              prefix: /*#__PURE__*/_jsxDEV(LockOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 53\n              }, this),\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u767B\\u5F55\\u5BC6\\u7801\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            className: systemStyle.Item,\n            children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n              className: systemStyle.left,\n              name: \"code\",\n              children: /*#__PURE__*/_jsxDEV(_Input, {\n                placeholder: \"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n              className: systemStyle.right,\n              children: /*#__PURE__*/_jsxDEV(RandomCode, {\n                height: 30\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            children: /*#__PURE__*/_jsxDEV(_Button, {\n              block: true,\n              type: \"primary\",\n              htmlType: \"submit\",\n              loading: this.state.loading,\n              className: systemStyle.btu,\n              children: \"\\u767B\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\u5F55\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: systemStyle.link,\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"/system/resetPwd\",\n            children: \"\\u5FD8\\u8BB0\\u5BC6\\u7801\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(Login);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/src/pages/System/Login/index.jsx"],"names":["React","Component","LockOutlined","UserOutlined","axios","withRouter","Store","RandomCode","systemStyle","Code","saveUserInfo","store","Login","state","loading","toLogin","form","getFieldValue","toLocaleLowerCase","getState","code","error","title","content","uid","pwd","getFieldsValue","setState","timer","setTimeout","url","method","data","then","response","clearTimeout","console","log","success","dispatch","userObj","props","history","replace","catch","e","render","frame","require","default","back","span","element","item","required","type","pattern","message","Item","left","right","btu","link"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Button, Form, Input, Modal} from \"antd\";\r\nimport {LockOutlined, UserOutlined} from \"@ant-design/icons\";\r\nimport axios from \"axios\";\r\nimport {withRouter} from \"react-router\";\r\n\r\nimport Store from '../../../redux/store';\r\nimport RandomCode from \"../../../components/RandomCode\";\r\nimport systemStyle from \"./index.module.css\";\r\nimport {Code} from \"../../../resource/constant\";\r\nimport {saveUserInfo} from \"../../../redux/actions/byUserInfo\";\r\n\r\nconst {store} = Store;\r\n\r\nclass Login extends Component {\r\n\r\n    state = {loading: false};\r\n\r\n    toLogin = () => {\r\n        if (this.form.getFieldValue('code').toLocaleLowerCase() !== store.getState().code.toLocaleLowerCase()) {\r\n            Modal.error({\r\n                title: '错误',\r\n                content: '验证码有误，请重新输入！'\r\n            });\r\n        } else {\r\n            const {uid, pwd} = this.form.getFieldsValue();\r\n            this.setState({loading: true});\r\n            //等待15S后超时\r\n            const timer = setTimeout(() => {\r\n                this.setState({loading: false}, () => {\r\n                    Modal.error({\r\n                        title: '错误',\r\n                        content: '网络连接超时！请检查您的网络配置，并尝试再次登录。'\r\n                    })\r\n                })\r\n            }, 15000);\r\n            axios({\r\n                url: 'http://localhost:3000/api/system',\r\n                method: 'post',\r\n                data: {uid, pwd}\r\n            }).then(response => {\r\n                //清除定时器\r\n                clearTimeout(timer);\r\n                console.log(response.data);\r\n                switch (response.data.code) {\r\n                    case Code.error:\r\n                        Modal.error({title: '错误', content: '登录失败，该账号不存在，请检查登录账号及密码是否正确！'});\r\n                        break;\r\n                    case Code.success:\r\n                        store.dispatch(saveUserInfo(response.data.userObj));\r\n                        this.props.history.replace('/system/home');\r\n                        // console.log(store.getState().userInfo);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }).catch(e => {\r\n                // console.log(e);\r\n                Modal.error({title: '错误', content: e});\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={systemStyle.frame}>\r\n                <img src={require('../../../images/system_back.jpg').default} className={systemStyle.back} alt=''/>\r\n                <div className={systemStyle.content}>\r\n                    <h3>系统管理员登录</h3>\r\n                    <Form wrapperCol={{span: 24}} validateTrigger='onBlur' onFinish={this.toLogin}\r\n                          ref={element => {\r\n                              this.form = element\r\n                          }} className={systemStyle.form}>\r\n                        <Form.Item name='uid' className={systemStyle.item} hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                type: 'string',\r\n                                pattern: /^[A-Za-z0-9]{6,16}$/,\r\n                                message: '账号必须位7~16位字母或数字的组合'\r\n                            }\r\n                        ]}>\r\n                            <Input prefix={<UserOutlined/>} placeholder='请输入登录账号'/>\r\n                        </Form.Item>\r\n                        <Form.Item name='pwd' className={systemStyle.item}>\r\n                            <Input.Password prefix={<LockOutlined/>} placeholder='请输入登录密码'/>\r\n                        </Form.Item>\r\n                        <Form.Item className={systemStyle.Item}>\r\n                            <Form.Item className={systemStyle.left} name='code'>\r\n                                <Input placeholder='请输入验证码'/>\r\n                            </Form.Item>\r\n                            <Form.Item className={systemStyle.right}>\r\n                                <RandomCode height={30}/>\r\n                            </Form.Item>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Button block type='primary' htmlType='submit' loading={this.state.loading}\r\n                                    className={systemStyle.btu}>登&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;录</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                    <div className={systemStyle.link}>\r\n                        <a href='/system/resetPwd'>忘记密码</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(Login);\r\n"]},"metadata":{},"sourceType":"module"}