{"ast":null,"code":"\"use strict\";\n/**\n * @file 地图自定义覆盖物组件\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar common_1 = require(\"../common\");\n\nvar shallowequal_1 = tslib_1.__importDefault(require(\"shallowequal\"));\n\nvar CustomOverlayDom_1 = tslib_1.__importDefault(require(\"./CustomOverlayDom\"));\n\nvar Map_1 = require(\"../Map\");\n\n;\n/**\n * 在地图上通过传入DOM添加自定义覆盖物\n * @visibleName CustomOverlay 自定义覆盖物\n */\n\nvar CustomOverlay =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(CustomOverlay, _super);\n\n  function CustomOverlay(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.options = ['zIndex', 'offset', 'unit'];\n    return _this;\n  }\n\n  CustomOverlay.prototype.componentDidUpdate = function (prevProps) {\n    if (!shallowequal_1.default(this.props, prevProps)) {\n      this.initialize();\n    }\n  };\n\n  CustomOverlay.prototype.componentDidMount = function () {\n    this.initialize();\n  };\n\n  CustomOverlay.prototype.componentWillUnmount = function () {\n    this.destroy();\n  };\n\n  CustomOverlay.prototype.destroy = function () {\n    if (this.overlay && this.map) {\n      this.overlay.destroy();\n      this.map.removeOverlay(this.overlay); // @ts-ignore\n\n      this.instance = this.overlay = undefined;\n    }\n  };\n\n  CustomOverlay.prototype.initialize = function () {\n    var map = this.map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this.destroy();\n    var options = this.getOptions();\n    options.html = this.props.children;\n    var position = this.parsePosition(this.props.position); // @ts-ignore\n\n    this.instance = this.overlay = new CustomOverlayDom_1.default(position, options);\n    map.addOverlay(this.overlay);\n\n    if (this.props.autoViewport) {\n      map.setCenter(position);\n    }\n  };\n\n  CustomOverlay.prototype.parsePosition = function (position) {\n    var isMC = this.props.coordType === 'bd09mc';\n    var point;\n\n    if (position instanceof Array) {\n      point = new BMapGL.Point(position[0], position[1]);\n    } else if (position instanceof BMapGL.Point) {\n      point = position;\n    } else {\n      point = new BMapGL.Point(position.lng, position.lat);\n    }\n\n    if (isMC) {\n      point = BMapGL.Projection.convertMC2LL(point);\n    }\n\n    return point;\n  };\n\n  CustomOverlay.prototype.render = function () {\n    return null;\n  };\n\n  CustomOverlay.contextType = Map_1.MapContext;\n  return CustomOverlay;\n}(common_1.Component);\n\nexports.default = CustomOverlay;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Overlay/CustomOverlay.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","common_1","shallowequal_1","__importDefault","CustomOverlayDom_1","Map_1","CustomOverlay","_super","__extends","props","_this","call","options","prototype","componentDidUpdate","prevProps","default","initialize","componentDidMount","componentWillUnmount","destroy","overlay","map","removeOverlay","instance","undefined","getMap","getOptions","html","children","position","parsePosition","addOverlay","autoViewport","setCenter","isMC","coordType","point","Array","BMapGL","Point","lng","lat","Projection","convertMC2LL","render","contextType","MapContext","Component"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @file 地图自定义覆盖物组件\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar common_1 = require(\"../common\");\nvar shallowequal_1 = tslib_1.__importDefault(require(\"shallowequal\"));\nvar CustomOverlayDom_1 = tslib_1.__importDefault(require(\"./CustomOverlayDom\"));\nvar Map_1 = require(\"../Map\");\n;\n/**\n * 在地图上通过传入DOM添加自定义覆盖物\n * @visibleName CustomOverlay 自定义覆盖物\n */\nvar CustomOverlay = /** @class */ (function (_super) {\n    tslib_1.__extends(CustomOverlay, _super);\n    function CustomOverlay(props) {\n        var _this = _super.call(this, props) || this;\n        _this.options = [\n            'zIndex',\n            'offset',\n            'unit'\n        ];\n        return _this;\n    }\n    CustomOverlay.prototype.componentDidUpdate = function (prevProps) {\n        if (!shallowequal_1.default(this.props, prevProps)) {\n            this.initialize();\n        }\n    };\n    CustomOverlay.prototype.componentDidMount = function () {\n        this.initialize();\n    };\n    CustomOverlay.prototype.componentWillUnmount = function () {\n        this.destroy();\n    };\n    CustomOverlay.prototype.destroy = function () {\n        if (this.overlay && this.map) {\n            this.overlay.destroy();\n            this.map.removeOverlay(this.overlay);\n            // @ts-ignore\n            this.instance = this.overlay = undefined;\n        }\n    };\n    CustomOverlay.prototype.initialize = function () {\n        var map = this.map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this.destroy();\n        var options = this.getOptions();\n        options.html = this.props.children;\n        var position = this.parsePosition(this.props.position);\n        // @ts-ignore\n        this.instance = this.overlay = new CustomOverlayDom_1.default(position, options);\n        map.addOverlay(this.overlay);\n        if (this.props.autoViewport) {\n            map.setCenter(position);\n        }\n    };\n    CustomOverlay.prototype.parsePosition = function (position) {\n        var isMC = this.props.coordType === 'bd09mc';\n        var point;\n        if (position instanceof Array) {\n            point = new BMapGL.Point(position[0], position[1]);\n        }\n        else if (position instanceof BMapGL.Point) {\n            point = position;\n        }\n        else {\n            point = new BMapGL.Point(position.lng, position.lat);\n        }\n        if (isMC) {\n            point = BMapGL.Projection.convertMC2LL(point);\n        }\n        return point;\n    };\n    CustomOverlay.prototype.render = function () {\n        return null;\n    };\n    CustomOverlay.contextType = Map_1.MapContext;\n    return CustomOverlay;\n}(common_1.Component));\nexports.default = CustomOverlay;\n"]},"metadata":{},"sourceType":"script"}