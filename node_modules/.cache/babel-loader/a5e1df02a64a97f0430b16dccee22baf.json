{"ast":null,"code":"\"use strict\";\n/**\n * @file 地图测距工具库\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar common_1 = require(\"../common\");\n\nvar requireScript_1 = require(\"../utils/requireScript\");\n\nvar WrapperHOC_1 = tslib_1.__importStar(require(\"../common/WrapperHOC\"));\n\nvar Map_1 = require(\"../Map\");\n\nvar eventsMap = ['drawend', 'addpoint', 'removepolyline'];\nvar methodsMap = {};\n\nvar DistanceTool =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(DistanceTool, _super);\n\n  function DistanceTool(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.options = ['tips', 'followText', 'unit', 'lineColor', 'lineStroke', 'opacity', 'lineStyle', 'cursor', 'secIcon', 'closeIcon'];\n    return _this;\n  }\n\n  DistanceTool.prototype.componentDidMount = function () {\n    this.initialize();\n  };\n\n  DistanceTool.prototype.componentWillUnmount = function () {\n    this.destroy();\n  };\n\n  DistanceTool.prototype.destroy = function () {\n    if (this.distancetool) {\n      this.distancetool.close(); // @ts-ignore\n\n      this.instance = this.distancetool = undefined;\n    }\n  };\n\n  DistanceTool.prototype.initialize = function () {\n    var _this = this;\n\n    var map = this.map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this.destroy();\n    var opts = this.getOptions(); // 如果 BMapGLLib 已经加载过，会执行下面的\n\n    if (window.BMapGLLib && BMapGLLib.DistanceTool) {\n      this.instance = this.distancetool = new BMapGLLib.DistanceTool(map, opts);\n\n      if (this.props.defaultOpen) {\n        this.distancetool.open();\n      }\n    } // 如果第一次加载，会执行下面的\n\n\n    if (!window.BMapGLLib || !BMapGLLib.DistanceTool) {\n      requireScript_1.requireScript('//mapopen.bj.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.js').then(function () {\n        _this.instance = _this.distancetool = new BMapGLLib.DistanceTool(map, opts); // 因为是异步加载，所以不会自动注册事件和执行方法，需要手动注册和执行\n\n        WrapperHOC_1.registerEvents(_this, _this.getInstance(_this), eventsMap);\n        WrapperHOC_1.toggleMethods(_this, _this.getInstance(_this), methodsMap);\n\n        if (_this.props.defaultOpen) {\n          _this.distancetool.open();\n        }\n      });\n    }\n  };\n\n  DistanceTool.prototype.render = function () {\n    return null;\n  };\n\n  DistanceTool.contextType = Map_1.MapContext;\n  return DistanceTool;\n}(common_1.Component);\n\nDistanceTool.defaultProps = {\n  defaultOpen: true\n};\n/**\n * 用来在地图上测量地理距离，单击添加拐点，双击结束测量。该组件属于不属于原生JSAPI，属于开源工具库[BMapGLLib](https://github.com/huiyan-fe/BMapGLLib)\n * @visibleName DistanceTool 地图测距工具\n */\n\nexports.default = WrapperHOC_1.default(DistanceTool, eventsMap, methodsMap);","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Library/DistanceTool.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","common_1","requireScript_1","WrapperHOC_1","__importStar","Map_1","eventsMap","methodsMap","DistanceTool","_super","__extends","props","_this","call","options","prototype","componentDidMount","initialize","componentWillUnmount","destroy","distancetool","close","instance","undefined","map","getMap","opts","getOptions","window","BMapGLLib","defaultOpen","open","requireScript","then","registerEvents","getInstance","toggleMethods","render","contextType","MapContext","Component","defaultProps","default"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @file 地图测距工具库\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar common_1 = require(\"../common\");\nvar requireScript_1 = require(\"../utils/requireScript\");\nvar WrapperHOC_1 = tslib_1.__importStar(require(\"../common/WrapperHOC\"));\nvar Map_1 = require(\"../Map\");\nvar eventsMap = [\n    'drawend',\n    'addpoint',\n    'removepolyline'\n];\nvar methodsMap = {};\nvar DistanceTool = /** @class */ (function (_super) {\n    tslib_1.__extends(DistanceTool, _super);\n    function DistanceTool(props) {\n        var _this = _super.call(this, props) || this;\n        _this.options = [\n            'tips',\n            'followText',\n            'unit',\n            'lineColor',\n            'lineStroke',\n            'opacity',\n            'lineStyle',\n            'cursor',\n            'secIcon',\n            'closeIcon'\n        ];\n        return _this;\n    }\n    DistanceTool.prototype.componentDidMount = function () {\n        this.initialize();\n    };\n    DistanceTool.prototype.componentWillUnmount = function () {\n        this.destroy();\n    };\n    DistanceTool.prototype.destroy = function () {\n        if (this.distancetool) {\n            this.distancetool.close();\n            // @ts-ignore\n            this.instance = this.distancetool = undefined;\n        }\n    };\n    DistanceTool.prototype.initialize = function () {\n        var _this = this;\n        var map = this.map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this.destroy();\n        var opts = this.getOptions();\n        // 如果 BMapGLLib 已经加载过，会执行下面的\n        if (window.BMapGLLib && BMapGLLib.DistanceTool) {\n            this.instance = this.distancetool = new BMapGLLib.DistanceTool(map, opts);\n            if (this.props.defaultOpen) {\n                this.distancetool.open();\n            }\n        }\n        // 如果第一次加载，会执行下面的\n        if (!window.BMapGLLib || !BMapGLLib.DistanceTool) {\n            requireScript_1.requireScript('//mapopen.bj.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.js')\n                .then(function () {\n                _this.instance = _this.distancetool = new BMapGLLib.DistanceTool(map, opts);\n                // 因为是异步加载，所以不会自动注册事件和执行方法，需要手动注册和执行\n                WrapperHOC_1.registerEvents(_this, _this.getInstance(_this), eventsMap);\n                WrapperHOC_1.toggleMethods(_this, _this.getInstance(_this), methodsMap);\n                if (_this.props.defaultOpen) {\n                    _this.distancetool.open();\n                }\n            });\n        }\n    };\n    DistanceTool.prototype.render = function () {\n        return null;\n    };\n    DistanceTool.contextType = Map_1.MapContext;\n    return DistanceTool;\n}(common_1.Component));\nDistanceTool.defaultProps = {\n    defaultOpen: true\n};\n/**\n * 用来在地图上测量地理距离，单击添加拐点，双击结束测量。该组件属于不属于原生JSAPI，属于开源工具库[BMapGLLib](https://github.com/huiyan-fe/BMapGLLib)\n * @visibleName DistanceTool 地图测距工具\n */\nexports.default = WrapperHOC_1.default(DistanceTool, eventsMap, methodsMap);\n"]},"metadata":{},"sourceType":"script"}