{"ast":null,"code":"import \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style/css\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/tree/style/css\";\nimport _Tree from \"antd/es/tree\";\nimport \"antd/es/spin/style/css\";\nimport _Spin from \"antd/es/spin\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nvar _jsxFileName = \"D:\\\\WebStorm Project\\\\flowingcloud\\\\src\\\\pages\\\\Admin\\\\WorkSpace\\\\AddGroups\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport axios from \"axios\";\nimport { ApartmentOutlined, DeleteOutlined, EditOutlined, PlusOutlined } from \"@ant-design/icons\";\nimport Store from \"../../../../redux/store\";\nimport addGroupStyle from './index.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  store\n} = Store;\nconst {\n  Column\n} = _Table;\nconst {\n  Search\n} = _Input;\n\nclass AddGroups extends Component {\n  constructor(props) {\n    super(props);\n\n    this.showGroupInfo = (selectedKeys, _) => {\n      if (selectedKeys.length === 0) return;\n      const {\n        groups\n      } = this.state;\n      let selected = {};\n\n      for (let i = 0; i < groups.length; i++) {\n        if (groups[i].groupCode === selectedKeys[0]) {\n          selected.groupName = groups[i].groupName;\n          selected.members = groups[i].groupMembers;\n          selected.key = groups[i].groupCode;\n          selected.parent = '--';\n          const parent = groups[i].parent;\n\n          for (let j = 0; j < groups.length; j++) {\n            if (groups[j].groupCode === parent) {\n              selected.parent = groups[j].groupName;\n              break;\n            }\n          }\n\n          break;\n        }\n      }\n\n      this.setState({\n        selected\n      });\n    };\n\n    this.getEnableGroup = () => {\n      const {\n        groups,\n        selected,\n        enableGroup\n      } = this.state;\n\n      for (let i = 0; i < groups.length; i++) {\n        if (i === 0 && groups[i].groupCode === selected.key) {\n          enableGroup.push({\n            title: groups[i].groupName,\n            value: groups[i].groupCode\n          });\n          break;\n        }\n\n        if (groups[i].groupCode === selected.key || groups[i].parent === selected.key) {\n          continue;\n        }\n\n        if (groups[i].parent) {\n          for (let j = i + 1; j < groups.length; j++) {\n            if (groups[j].groupCode === groups[i].parent) {\n              if (!groups[j].children) {\n                groups[j].children = [];\n              }\n\n              let tmp = '';\n\n              if (groups[i].children) {\n                tmp = {\n                  title: groups[i].groupName,\n                  value: groups[i].groupCode,\n                  children: groups[i].children\n                };\n              } else {\n                tmp = {\n                  title: groups[i].groupName,\n                  value: groups[i].groupCode\n                };\n              }\n\n              groups[j].children.push(tmp);\n            }\n          }\n        }\n      }\n    };\n\n    this.editGroupInfo = () => {};\n\n    this.state = {\n      loading: true,\n      option: '',\n      enableGroup: []\n    };\n    axios({\n      url: 'http://localhost:3000/api/orgGroup',\n      method: 'post',\n      headers: {\n        authorization: store.getState().token\n      }\n    }).then(response => {\n      const {\n        groups\n      } = response.data;\n      let treeData = ''; //加工组织数据\n\n      for (let i = 0; i < groups.length; i++) {\n        if (groups[i].parent) {\n          for (let j = i + 1; j < groups.length; j++) {\n            if (groups[j].groupCode === groups[i].parent) {\n              if (!groups[j].children) {\n                groups[j].children = [];\n              }\n\n              let tmp = '';\n\n              if (groups[i].children) {\n                tmp = {\n                  title: groups[i].groupName,\n                  key: groups[i].groupCode,\n                  children: groups[i].children\n                };\n              } else {\n                tmp = {\n                  title: groups[i].groupName,\n                  key: groups[i].groupCode\n                };\n              }\n\n              groups[j].children.push(tmp);\n            }\n          }\n        } else {\n          treeData = [{\n            title: groups[i].groupName,\n            key: groups[i].groupCode,\n            children: groups[i].children ? groups[i].children : []\n          }];\n        }\n      }\n\n      this.setState({\n        loading: false,\n        groups,\n        treeData\n      }, () => {\n        console.log('groups', groups);\n        console.log('treeData', treeData);\n      });\n    }).catch();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: addGroupStyle.container,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: addGroupStyle.left,\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          placeholder: \"\\u641C\\u7D22\\u7EC4\\u7EC7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '10px'\n          },\n          children: this.state.loading ? /*#__PURE__*/_jsxDEV(_Spin, {\n            tip: \"\\u6B63\\u5728\\u83B7\\u53D6\\u7EC4\\u7EC7\\u4FE1\\u606F\\uFF0C\\u8BF7\\u7A0D\\u5019......\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(_Tree, {\n            treeData: this.state.treeData,\n            icon: /*#__PURE__*/_jsxDEV(ApartmentOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 76\n            }, this),\n            showIcon: true,\n            showLine: {\n              showLeafIcon: false\n            },\n            onSelect: this.showGroupInfo\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: addGroupStyle.info,\n        children: /*#__PURE__*/_jsxDEV(_Table, {\n          locale: {\n            emptyText: '请选中具体组织后进行操作！'\n          },\n          pagination: {\n            hideOnSinglePage: true\n          },\n          dataSource: this.state.selected ? [this.state.selected] : [],\n          children: [/*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u7EC4\\u7EC7\\u540D\\u79F0\",\n            dataIndex: \"groupName\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'groupName', false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u4E0A\\u7EA7\\u7EC4\\u7EC7\",\n            dataIndex: \"parent\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'parent', false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u6210\\u5458\\u6570\\u91CF\",\n            dataIndex: \"members\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'members', false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u64CD\\u4F5C\",\n            dataIndex: \"option\",\n            align: \"center\",\n            width: \"25%\",\n            render: () => /*#__PURE__*/_jsxDEV(_Space, {\n              size: 10,\n              children: [/*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(EditOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u7F16\\u8F91\\u7EC4\\u7EC7\",\n                onClick: this.editGroupInfo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u589E\\u52A0\\u4E0B\\u7EA7\\u7EC4\\u7EC7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u5220\\u9664\\u7EC4\\u7EC7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n        title: \"\\u7F16\\u8F91\\u7EC4\\u7EC7\",\n        maskClosable: false,\n        visible: this.state.option === 'edit',\n        onCancel: () => {\n          this.setState({\n            option: ''\n          });\n        },\n        children: /*#__PURE__*/_jsxDEV(_Form, {\n          children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u7EC4\\u7EC7\\u540D\\u79F0\",\n            children: /*#__PURE__*/_jsxDEV(_Input, {\n              value: this.state.selected.groupName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u4E0A\\u7EA7\\u7EC4\\u7EC7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default AddGroups;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/src/pages/Admin/WorkSpace/AddGroups/index.jsx"],"names":["React","Component","axios","ApartmentOutlined","DeleteOutlined","EditOutlined","PlusOutlined","Store","addGroupStyle","store","Column","Search","AddGroups","constructor","props","showGroupInfo","selectedKeys","_","length","groups","state","selected","i","groupCode","groupName","members","groupMembers","key","parent","j","setState","getEnableGroup","enableGroup","push","title","value","children","tmp","editGroupInfo","loading","option","url","method","headers","authorization","getState","token","then","response","data","treeData","console","log","catch","render","container","left","marginTop","showLeafIcon","info","emptyText","hideOnSinglePage"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Button, Space, Spin, Table, Tree, Input, Modal, Form} from \"antd\";\r\nimport axios from \"axios\";\r\nimport {ApartmentOutlined, DeleteOutlined, EditOutlined, PlusOutlined} from \"@ant-design/icons\";\r\nimport Store from \"../../../../redux/store\";\r\nimport addGroupStyle from './index.module.css';\r\n\r\nconst {store} = Store;\r\nconst {Column} = Table;\r\nconst {Search} = Input;\r\n\r\nclass AddGroups extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {loading: true, option: '', enableGroup: []};\r\n        axios({\r\n            url: 'http://localhost:3000/api/orgGroup',\r\n            method: 'post',\r\n            headers: {authorization: store.getState().token}\r\n        }).then(response => {\r\n            const {groups} = response.data;\r\n            let treeData = '';\r\n\r\n            //加工组织数据\r\n            for (let i = 0; i < groups.length; i++) {\r\n                if (groups[i].parent) {\r\n                    for (let j = i + 1; j < groups.length; j++) {\r\n                        if (groups[j].groupCode === groups[i].parent) {\r\n                            if (!groups[j].children) {\r\n                                groups[j].children = [];\r\n                            }\r\n                            let tmp = '';\r\n                            if (groups[i].children) {\r\n                                tmp = {\r\n                                    title: groups[i].groupName,\r\n                                    key: groups[i].groupCode,\r\n                                    children: groups[i].children\r\n                                }\r\n                            } else {\r\n                                tmp = {\r\n                                    title: groups[i].groupName,\r\n                                    key: groups[i].groupCode\r\n                                }\r\n                            }\r\n                            groups[j].children.push(tmp);\r\n                        }\r\n                    }\r\n                } else {\r\n                    treeData = [{\r\n                        title: groups[i].groupName,\r\n                        key: groups[i].groupCode,\r\n                        children: groups[i].children ? groups[i].children : []\r\n                    }];\r\n                }\r\n            }\r\n\r\n            this.setState({loading: false, groups, treeData}, () => {\r\n                console.log('groups',groups);\r\n                console.log('treeData',treeData);\r\n            });\r\n        }).catch();\r\n    }\r\n\r\n    showGroupInfo = (selectedKeys, _) => {\r\n        if (selectedKeys.length === 0)\r\n            return;\r\n        const {groups} = this.state;\r\n        let selected = {};\r\n        for (let i = 0; i < groups.length; i++) {\r\n            if (groups[i].groupCode === selectedKeys[0]) {\r\n                selected.groupName = groups[i].groupName;\r\n                selected.members = groups[i].groupMembers;\r\n                selected.key = groups[i].groupCode;\r\n                selected.parent = '--';\r\n                const parent = groups[i].parent;\r\n                for (let j = 0; j < groups.length; j++) {\r\n                    if (groups[j].groupCode === parent) {\r\n                        selected.parent = groups[j].groupName;\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n\r\n        }\r\n        this.setState({selected});\r\n    }\r\n\r\n    getEnableGroup = () => {\r\n        const {groups,selected,enableGroup}=this.state;\r\n        for (let i = 0; i < groups.length; i++) {\r\n            if (i===0&&groups[i].groupCode===selected.key){\r\n                enableGroup.push({title:groups[i].groupName,value:groups[i].groupCode});\r\n                break;\r\n            }\r\n            if (groups[i].groupCode===selected.key||groups[i].parent===selected.key){\r\n                continue;\r\n            }\r\n            if (groups[i].parent) {\r\n                for (let j = i + 1; j < groups.length; j++) {\r\n                    if (groups[j].groupCode === groups[i].parent) {\r\n                        if (!groups[j].children) {\r\n                            groups[j].children = [];\r\n                        }\r\n                        let tmp = '';\r\n                        if (groups[i].children) {\r\n                            tmp = {\r\n                                title: groups[i].groupName,\r\n                                value: groups[i].groupCode,\r\n                                children: groups[i].children\r\n                            }\r\n                        } else {\r\n                            tmp = {\r\n                                title: groups[i].groupName,\r\n                                value: groups[i].groupCode\r\n                            }\r\n                        }\r\n                        groups[j].children.push(tmp);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    editGroupInfo = () => {\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div className={addGroupStyle.container}>\r\n                <div className={addGroupStyle.left}>\r\n                    <Search placeholder='搜索组织'/>\r\n                    <div style={{marginTop: '10px'}}>\r\n                        {\r\n                            this.state.loading ?\r\n                                <Spin tip='正在获取组织信息，请稍候......'/> :\r\n                                <Tree treeData={this.state.treeData} icon={<ApartmentOutlined/>} showIcon={true}\r\n                                      showLine={{showLeafIcon: false}} onSelect={this.showGroupInfo}/>\r\n                        }\r\n                    </div>\r\n                </div>\r\n                <div className={addGroupStyle.info}>\r\n                    <Table locale={{emptyText: '请选中具体组织后进行操作！'}} pagination={{hideOnSinglePage: true}}\r\n                           dataSource={this.state.selected ? [this.state.selected] : []}>\r\n                        <Column title='组织名称' dataIndex='groupName' key='groupName' align='center' width='25%'/>\r\n                        <Column title='上级组织' dataIndex='parent' key='parent' align='center' width='25%'/>\r\n                        <Column title='成员数量' dataIndex='members' key='members' align='center' width='25%'/>\r\n                        <Column title='操作' dataIndex='option' align='center' width='25%'\r\n                                render={() => (\r\n                                    <Space size={10}>\r\n                                        <Button type='link' icon={<EditOutlined/>} title='编辑组织'\r\n                                                onClick={this.editGroupInfo}/>\r\n                                        <Button type='link' icon={<PlusOutlined/>} title='增加下级组织'/>\r\n                                        <Button type='link' icon={<DeleteOutlined/>} title='删除组织'/>\r\n                                    </Space>\r\n                                )}/>\r\n                    </Table>\r\n                </div>\r\n                <Modal title='编辑组织' maskClosable={false} visible={this.state.option === 'edit'} onCancel={() => {\r\n                    this.setState({option: ''})\r\n                }}>\r\n                    <Form>\r\n                        <Form.Item label='组织名称'>\r\n                            <Input value={this.state.selected.groupName}/>\r\n                        </Form.Item>\r\n                        <Form.Item label='上级组织'>\r\n\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AddGroups;\r\n"]},"metadata":{},"sourceType":"module"}