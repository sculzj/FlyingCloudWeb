{"ast":null,"code":"\"use strict\";\n/**\n * @file 文本标注\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar common_1 = require(\"../common\");\n\nvar WrapperHOC_1 = tslib_1.__importDefault(require(\"../common/WrapperHOC\"));\n\nvar shallowequal_1 = tslib_1.__importDefault(require(\"shallowequal\"));\n\nvar Map_1 = require(\"../Map\");\n\n;\nvar eventsMap = ['click', 'dblclick', 'rightclick', 'mousedown', 'mouseup', 'mouseout', 'mouseover', 'mousemove', 'remove'];\nvar methodsMap = {\n  enableMassClear: ['enableMassClear', 'disableMassClear']\n};\n\nvar Label =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(Label, _super);\n\n  function Label(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.options = ['position', 'offset', 'enableMassClear'];\n    return _this;\n  }\n\n  Label.prototype.componentDidUpdate = function (prevProps) {\n    var _a = this.props,\n        position = _a.position,\n        offset = _a.offset,\n        text = _a.text,\n        style = _a.style;\n    var prePosition = prevProps.position,\n        preOffset = prevProps.offset,\n        preText = prevProps.text,\n        preStyle = prevProps.style;\n    var isDataChanged = position && !shallowequal_1.default(position, prePosition);\n    var isOffsetChanged = !!(offset && !shallowequal_1.default(offset, preOffset));\n    var isTextChanged = !shallowequal_1.default(text, preText);\n    var isStyleChanged = !!(style && !shallowequal_1.default(style, preStyle));\n    var point = this.parsePosition(position);\n\n    if (isDataChanged) {\n      this.label.setPosition(point);\n    }\n\n    if (isOffsetChanged) {\n      this.label.setOffset(offset);\n    }\n\n    if (isTextChanged) {\n      this.label.setContent(text);\n    }\n\n    if (isStyleChanged) {\n      this.label.setStyle(style);\n    }\n  };\n\n  Label.prototype.componentDidMount = function () {\n    this.initialize();\n  };\n\n  Label.prototype.componentWillUnmount = function () {\n    this.destroy();\n  };\n\n  Label.prototype.destroy = function () {\n    if (this.label) {\n      this.map.removeOverlay(this.label); // @ts-ignore\n\n      this.instance = this.label = undefined;\n    }\n  };\n\n  Label.prototype.initialize = function () {\n    var map = this.map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this.destroy();\n    var options = this.getOptions();\n    var position = this.parsePosition(this.props.position);\n    options.position = position;\n    this.instance = this.label = new BMapGL.Label(this.props.text || '', options);\n    map.addOverlay(this.label);\n\n    if (this.props.style) {\n      this.label.setStyle(this.props.style);\n    }\n  };\n\n  Label.prototype.parsePosition = function (position) {\n    var isMC = this.props.coordType === 'bd09mc';\n    var point;\n\n    if (position instanceof Array) {\n      point = new BMapGL.Point(position[0], position[1]);\n    } else if (position instanceof BMapGL.Point) {\n      point = position;\n    } else {\n      point = new BMapGL.Point(position.lng, position.lat);\n    }\n\n    if (isMC) {\n      point = BMapGL.Projection.convertMC2LL(point);\n    }\n\n    return point;\n  };\n\n  Label.prototype.render = function () {\n    return null;\n  };\n\n  Label.contextType = Map_1.MapContext;\n  return Label;\n}(common_1.Component);\n/**\n * defaultProps属性要放在外面，不然生成API文档时，没有默认值\n */\n\n\nLabel.defaultProps = {\n  style: {\n    color: 'red'\n  }\n};\n/**\n *\n * @visibleName Label 文本标注\n */\n\nexports.default = WrapperHOC_1.default(Label, eventsMap, methodsMap);","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Overlay/Label.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","common_1","WrapperHOC_1","__importDefault","shallowequal_1","Map_1","eventsMap","methodsMap","enableMassClear","Label","_super","__extends","props","_this","call","options","prototype","componentDidUpdate","prevProps","_a","position","offset","text","style","prePosition","preOffset","preText","preStyle","isDataChanged","default","isOffsetChanged","isTextChanged","isStyleChanged","point","parsePosition","label","setPosition","setOffset","setContent","setStyle","componentDidMount","initialize","componentWillUnmount","destroy","map","removeOverlay","instance","undefined","getMap","getOptions","BMapGL","addOverlay","isMC","coordType","Array","Point","lng","lat","Projection","convertMC2LL","render","contextType","MapContext","Component","defaultProps","color"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @file 文本标注\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar common_1 = require(\"../common\");\nvar WrapperHOC_1 = tslib_1.__importDefault(require(\"../common/WrapperHOC\"));\nvar shallowequal_1 = tslib_1.__importDefault(require(\"shallowequal\"));\nvar Map_1 = require(\"../Map\");\n;\nvar eventsMap = [\n    'click',\n    'dblclick',\n    'rightclick',\n    'mousedown',\n    'mouseup',\n    'mouseout',\n    'mouseover',\n    'mousemove',\n    'remove',\n];\nvar methodsMap = {\n    enableMassClear: ['enableMassClear', 'disableMassClear']\n};\nvar Label = /** @class */ (function (_super) {\n    tslib_1.__extends(Label, _super);\n    function Label(props) {\n        var _this = _super.call(this, props) || this;\n        _this.options = [\n            'position',\n            'offset',\n            'enableMassClear',\n        ];\n        return _this;\n    }\n    Label.prototype.componentDidUpdate = function (prevProps) {\n        var _a = this.props, position = _a.position, offset = _a.offset, text = _a.text, style = _a.style;\n        var prePosition = prevProps.position, preOffset = prevProps.offset, preText = prevProps.text, preStyle = prevProps.style;\n        var isDataChanged = position && !shallowequal_1.default(position, prePosition);\n        var isOffsetChanged = !!(offset && !shallowequal_1.default(offset, preOffset));\n        var isTextChanged = !shallowequal_1.default(text, preText);\n        var isStyleChanged = !!(style && !shallowequal_1.default(style, preStyle));\n        var point = this.parsePosition(position);\n        if (isDataChanged) {\n            this.label.setPosition(point);\n        }\n        if (isOffsetChanged) {\n            this.label.setOffset(offset);\n        }\n        if (isTextChanged) {\n            this.label.setContent(text);\n        }\n        if (isStyleChanged) {\n            this.label.setStyle(style);\n        }\n    };\n    Label.prototype.componentDidMount = function () {\n        this.initialize();\n    };\n    Label.prototype.componentWillUnmount = function () {\n        this.destroy();\n    };\n    Label.prototype.destroy = function () {\n        if (this.label) {\n            this.map.removeOverlay(this.label);\n            // @ts-ignore\n            this.instance = this.label = undefined;\n        }\n    };\n    Label.prototype.initialize = function () {\n        var map = this.map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this.destroy();\n        var options = this.getOptions();\n        var position = this.parsePosition(this.props.position);\n        options.position = position;\n        this.instance = this.label = new BMapGL.Label(this.props.text || '', options);\n        map.addOverlay(this.label);\n        if (this.props.style) {\n            this.label.setStyle(this.props.style);\n        }\n    };\n    Label.prototype.parsePosition = function (position) {\n        var isMC = this.props.coordType === 'bd09mc';\n        var point;\n        if (position instanceof Array) {\n            point = new BMapGL.Point(position[0], position[1]);\n        }\n        else if (position instanceof BMapGL.Point) {\n            point = position;\n        }\n        else {\n            point = new BMapGL.Point(position.lng, position.lat);\n        }\n        if (isMC) {\n            point = BMapGL.Projection.convertMC2LL(point);\n        }\n        return point;\n    };\n    Label.prototype.render = function () {\n        return null;\n    };\n    Label.contextType = Map_1.MapContext;\n    return Label;\n}(common_1.Component));\n/**\n * defaultProps属性要放在外面，不然生成API文档时，没有默认值\n */\nLabel.defaultProps = {\n    style: { color: 'red' }\n};\n/**\n *\n * @visibleName Label 文本标注\n */\nexports.default = WrapperHOC_1.default(Label, eventsMap, methodsMap);\n"]},"metadata":{},"sourceType":"script"}