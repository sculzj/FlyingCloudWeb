{"ast":null,"code":"\"use strict\";\n/**\n * @file 鼠标绘制工具库\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importDefault(require(\"react\"));\n\nvar common_1 = require(\"../common\");\n\nvar requireScript_1 = require(\"../utils/requireScript\");\n\nvar WrapperHOC_1 = tslib_1.__importStar(require(\"../common/WrapperHOC\"));\n\nvar Map_1 = require(\"../Map\");\n\nvar eventsMap = ['overlaycomplete', 'overlaycancel'];\nvar methodsMap = {\n  enableCalculate: ['enableCalculate', 'disableCalculate'],\n  enableSorption: ['enableSorption', 'disableSorption'],\n  enableGpc: ['enableGpc', 'disableGpc']\n};\nvar drawOptions = {\n  strokeColor: '#5E87DB',\n  fillColor: '#5E87DB',\n  strokeWeight: 2,\n  strokeOpacity: 1,\n  fillOpacity: 0.2\n};\nvar labelOptions = {\n  borderRadius: '2px',\n  background: '#FFFBCC',\n  border: '1px solid #E1E1E1',\n  color: '#703A04',\n  fontSize: '12px',\n  letterSpacing: '0',\n  padding: '5px'\n};\n\nvar DrawingManager =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(DrawingManager, _super);\n\n  function DrawingManager(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.el = react_1.default.createRef();\n    _this.options = ['isOpen', 'drawingMode', 'enableDrawingTool', 'enableCalculate', 'enableSorption', 'enableGpc', 'enableLimit', 'sorptionDistance', 'limitOptions', 'drawingToolOptions', 'markerOptions', 'circleOptions', 'polylineOptions', 'polygonOptions', 'rectangleOptions', 'labelOptions'];\n    return _this;\n  }\n\n  DrawingManager.prototype.componentDidMount = function () {\n    this.initialize();\n  };\n\n  DrawingManager.prototype.componentWillUnmount = function () {\n    this.destroy();\n  };\n\n  DrawingManager.prototype.destroy = function () {\n    if (this.drawingmanager) {\n      this.drawingmanager.close(); // @ts-ignore\n\n      this.instance = this.drawingmanager = undefined;\n    }\n  };\n\n  DrawingManager.prototype.initialize = function () {\n    var _this = this;\n\n    var map = this.map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this.destroy();\n    var opts = this.getOptions();\n    var drawStyles = ['circleOptions', 'polylineOptions', 'polygonOptions', 'rectangleOptions'];\n\n    for (var i = 0; i < drawStyles.length; i++) {\n      var styl = drawStyles[i];\n\n      if (!opts[styl]) {\n        opts[styl] = drawOptions;\n      }\n    }\n\n    if (!opts.labelOptions) {\n      opts.labelOptions = labelOptions;\n    }\n\n    opts.drawingToolOptions.customContainer = this.el.current; // 如果 BMapGLLib 已经加载过，会执行下面的\n\n    if (window.BMapGLLib && BMapGLLib.DrawingManager) {\n      this.instance = this.drawingmanager = new BMapGLLib.DrawingManager(map, opts);\n    } // 如果第一次加载，会执行下面的\n\n\n    if (!window.BMapGLLib || !BMapGLLib.DrawingManager) {\n      requireScript_1.requireCss('//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css').then(function () {});\n      requireScript_1.requireScript('//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js').then(function () {\n        _this.instance = _this.drawingmanager = new BMapGLLib.DrawingManager(map, opts); // 因为是异步加载，所以不会自动注册事件和执行方法，需要手动注册和执行\n\n        WrapperHOC_1.registerEvents(_this, _this.getInstance(_this), eventsMap);\n        WrapperHOC_1.toggleMethods(_this, _this.getInstance(_this), methodsMap);\n      });\n    }\n  };\n\n  DrawingManager.prototype.render = function () {\n    return react_1.default.createElement(\"div\", {\n      className: \"react-bmapgl-drawingmanager\",\n      ref: this.el,\n      style: this.props.style\n    });\n  };\n\n  DrawingManager.contextType = Map_1.MapContext;\n  return DrawingManager;\n}(common_1.Component);\n\nDrawingManager.defaultProps = {\n  isOpen: false,\n  enableDrawingTool: true,\n  enableCalculate: false,\n  enableSorption: false,\n  enableGpc: false,\n  enableLimit: false,\n  sorptionDistance: 20,\n  limitOptions: {\n    area: 50000000,\n    distance: 30000\n  },\n  drawingToolOptions: {},\n  style: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    width: 360\n  }\n};\n/**\n * 用来在地图上通过鼠标绘制覆盖物，该组件属于不属于原生JSAPI，属于开源工具库[BMapGLLib](https://github.com/huiyan-fe/BMapGLLib)\n * @visibleName DrawingManager 鼠标绘制工具\n */\n\nexports.default = WrapperHOC_1.default(DrawingManager, eventsMap, methodsMap);","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Library/DrawingManager.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","react_1","__importDefault","common_1","requireScript_1","WrapperHOC_1","__importStar","Map_1","eventsMap","methodsMap","enableCalculate","enableSorption","enableGpc","drawOptions","strokeColor","fillColor","strokeWeight","strokeOpacity","fillOpacity","labelOptions","borderRadius","background","border","color","fontSize","letterSpacing","padding","DrawingManager","_super","__extends","props","_this","call","el","default","createRef","options","prototype","componentDidMount","initialize","componentWillUnmount","destroy","drawingmanager","close","instance","undefined","map","getMap","opts","getOptions","drawStyles","i","length","styl","drawingToolOptions","customContainer","current","window","BMapGLLib","requireCss","then","requireScript","registerEvents","getInstance","toggleMethods","render","createElement","className","ref","style","contextType","MapContext","Component","defaultProps","isOpen","enableDrawingTool","enableLimit","sorptionDistance","limitOptions","area","distance","position","left","top","width"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAIC,OAAO,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIC,OAAO,GAAGF,OAAO,CAACG,eAAR,CAAwBF,OAAO,CAAC,OAAD,CAA/B,CAAd;;AACA,IAAIG,QAAQ,GAAGH,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAII,eAAe,GAAGJ,OAAO,CAAC,wBAAD,CAA7B;;AACA,IAAIK,YAAY,GAAGN,OAAO,CAACO,YAAR,CAAqBN,OAAO,CAAC,sBAAD,CAA5B,CAAnB;;AACA,IAAIO,KAAK,GAAGP,OAAO,CAAC,QAAD,CAAnB;;AACA,IAAIQ,SAAS,GAAG,CACZ,iBADY,EAEZ,eAFY,CAAhB;AAIA,IAAIC,UAAU,GAAG;AACbC,EAAAA,eAAe,EAAE,CAAC,iBAAD,EAAoB,kBAApB,CADJ;AAEbC,EAAAA,cAAc,EAAE,CAAC,gBAAD,EAAmB,iBAAnB,CAFH;AAGbC,EAAAA,SAAS,EAAE,CAAC,WAAD,EAAc,YAAd;AAHE,CAAjB;AAKA,IAAIC,WAAW,GAAG;AACdC,EAAAA,WAAW,EAAE,SADC;AAEdC,EAAAA,SAAS,EAAE,SAFG;AAGdC,EAAAA,YAAY,EAAE,CAHA;AAIdC,EAAAA,aAAa,EAAE,CAJD;AAKdC,EAAAA,WAAW,EAAE;AALC,CAAlB;AAOA,IAAIC,YAAY,GAAG;AACfC,EAAAA,YAAY,EAAE,KADC;AAEfC,EAAAA,UAAU,EAAE,SAFG;AAGfC,EAAAA,MAAM,EAAE,mBAHO;AAIfC,EAAAA,KAAK,EAAE,SAJQ;AAKfC,EAAAA,QAAQ,EAAE,MALK;AAMfC,EAAAA,aAAa,EAAE,GANA;AAOfC,EAAAA,OAAO,EAAE;AAPM,CAAnB;;AASA,IAAIC,cAAc;AAAG;AAAe,UAAUC,MAAV,EAAkB;AAClD7B,EAAAA,OAAO,CAAC8B,SAAR,CAAkBF,cAAlB,EAAkCC,MAAlC;;AACA,WAASD,cAAT,CAAwBG,KAAxB,EAA+B;AAC3B,QAAIC,KAAK,GAAGH,MAAM,CAACI,IAAP,CAAY,IAAZ,EAAkBF,KAAlB,KAA4B,IAAxC;;AACAC,IAAAA,KAAK,CAACE,EAAN,GAAWhC,OAAO,CAACiC,OAAR,CAAgBC,SAAhB,EAAX;AACAJ,IAAAA,KAAK,CAACK,OAAN,GAAgB,CACZ,QADY,EAEZ,aAFY,EAGZ,mBAHY,EAIZ,iBAJY,EAKZ,gBALY,EAMZ,WANY,EAOZ,aAPY,EAQZ,kBARY,EASZ,cATY,EAUZ,oBAVY,EAWZ,eAXY,EAYZ,eAZY,EAaZ,iBAbY,EAcZ,gBAdY,EAeZ,kBAfY,EAgBZ,cAhBY,CAAhB;AAkBA,WAAOL,KAAP;AACH;;AACDJ,EAAAA,cAAc,CAACU,SAAf,CAAyBC,iBAAzB,GAA6C,YAAY;AACrD,SAAKC,UAAL;AACH,GAFD;;AAGAZ,EAAAA,cAAc,CAACU,SAAf,CAAyBG,oBAAzB,GAAgD,YAAY;AACxD,SAAKC,OAAL;AACH,GAFD;;AAGAd,EAAAA,cAAc,CAACU,SAAf,CAAyBI,OAAzB,GAAmC,YAAY;AAC3C,QAAI,KAAKC,cAAT,EAAyB;AACrB,WAAKA,cAAL,CAAoBC,KAApB,GADqB,CAErB;;AACA,WAAKC,QAAL,GAAgB,KAAKF,cAAL,GAAsBG,SAAtC;AACH;AACJ,GAND;;AAOAlB,EAAAA,cAAc,CAACU,SAAf,CAAyBE,UAAzB,GAAsC,YAAY;AAC9C,QAAIR,KAAK,GAAG,IAAZ;;AACA,QAAIe,GAAG,GAAG,KAAKA,GAAL,GAAW,KAAKC,MAAL,EAArB;;AACA,QAAI,CAACD,GAAL,EAAU;AACN;AACH;;AACD,SAAKL,OAAL;AACA,QAAIO,IAAI,GAAG,KAAKC,UAAL,EAAX;AACA,QAAIC,UAAU,GAAG,CAAC,eAAD,EAAkB,iBAAlB,EAAqC,gBAArC,EAAuD,kBAAvD,CAAjB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,UAAU,CAACE,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AACxC,UAAIE,IAAI,GAAGH,UAAU,CAACC,CAAD,CAArB;;AACA,UAAI,CAACH,IAAI,CAACK,IAAD,CAAT,EAAiB;AACbL,QAAAA,IAAI,CAACK,IAAD,CAAJ,GAAaxC,WAAb;AACH;AACJ;;AACD,QAAI,CAACmC,IAAI,CAAC7B,YAAV,EAAwB;AACpB6B,MAAAA,IAAI,CAAC7B,YAAL,GAAoBA,YAApB;AACH;;AACD6B,IAAAA,IAAI,CAACM,kBAAL,CAAwBC,eAAxB,GAA0C,KAAKtB,EAAL,CAAQuB,OAAlD,CAlB8C,CAmB9C;;AACA,QAAIC,MAAM,CAACC,SAAP,IAAoBA,SAAS,CAAC/B,cAAlC,EAAkD;AAC9C,WAAKiB,QAAL,GAAgB,KAAKF,cAAL,GAAsB,IAAIgB,SAAS,CAAC/B,cAAd,CAA6BmB,GAA7B,EAAkCE,IAAlC,CAAtC;AACH,KAtB6C,CAuB9C;;;AACA,QAAI,CAACS,MAAM,CAACC,SAAR,IAAqB,CAACA,SAAS,CAAC/B,cAApC,EAAoD;AAChDvB,MAAAA,eAAe,CAACuD,UAAhB,CAA2B,oFAA3B,EACKC,IADL,CACU,YAAY,CAAG,CADzB;AAEAxD,MAAAA,eAAe,CAACyD,aAAhB,CAA8B,mFAA9B,EACKD,IADL,CACU,YAAY;AAClB7B,QAAAA,KAAK,CAACa,QAAN,GAAiBb,KAAK,CAACW,cAAN,GAAuB,IAAIgB,SAAS,CAAC/B,cAAd,CAA6BmB,GAA7B,EAAkCE,IAAlC,CAAxC,CADkB,CAElB;;AACA3C,QAAAA,YAAY,CAACyD,cAAb,CAA4B/B,KAA5B,EAAmCA,KAAK,CAACgC,WAAN,CAAkBhC,KAAlB,CAAnC,EAA6DvB,SAA7D;AACAH,QAAAA,YAAY,CAAC2D,aAAb,CAA2BjC,KAA3B,EAAkCA,KAAK,CAACgC,WAAN,CAAkBhC,KAAlB,CAAlC,EAA4DtB,UAA5D;AACH,OAND;AAOH;AACJ,GAnCD;;AAoCAkB,EAAAA,cAAc,CAACU,SAAf,CAAyB4B,MAAzB,GAAkC,YAAY;AAC1C,WAAQhE,OAAO,CAACiC,OAAR,CAAgBgC,aAAhB,CAA8B,KAA9B,EAAqC;AAAEC,MAAAA,SAAS,EAAE,6BAAb;AAA4CC,MAAAA,GAAG,EAAE,KAAKnC,EAAtD;AAA0DoC,MAAAA,KAAK,EAAE,KAAKvC,KAAL,CAAWuC;AAA5E,KAArC,CAAR;AACH,GAFD;;AAGA1C,EAAAA,cAAc,CAAC2C,WAAf,GAA6B/D,KAAK,CAACgE,UAAnC;AACA,SAAO5C,cAAP;AACH,CA/EmC,CA+ElCxB,QAAQ,CAACqE,SA/EyB,CAApC;;AAgFA7C,cAAc,CAAC8C,YAAf,GAA8B;AAC1BC,EAAAA,MAAM,EAAE,KADkB;AAE1BC,EAAAA,iBAAiB,EAAE,IAFO;AAG1BjE,EAAAA,eAAe,EAAE,KAHS;AAI1BC,EAAAA,cAAc,EAAE,KAJU;AAK1BC,EAAAA,SAAS,EAAE,KALe;AAM1BgE,EAAAA,WAAW,EAAE,KANa;AAO1BC,EAAAA,gBAAgB,EAAE,EAPQ;AAQ1BC,EAAAA,YAAY,EAAE;AACVC,IAAAA,IAAI,EAAE,QADI;AAEVC,IAAAA,QAAQ,EAAE;AAFA,GARY;AAY1B1B,EAAAA,kBAAkB,EAAE,EAZM;AAa1Be,EAAAA,KAAK,EAAE;AACHY,IAAAA,QAAQ,EAAE,UADP;AAEHC,IAAAA,IAAI,EAAE,CAFH;AAGHC,IAAAA,GAAG,EAAE,CAHF;AAIHC,IAAAA,KAAK,EAAE;AAJJ;AAbmB,CAA9B;AAoBA;AACA;AACA;AACA;;AACAvF,OAAO,CAACqC,OAAR,GAAkB7B,YAAY,CAAC6B,OAAb,CAAqBP,cAArB,EAAqCnB,SAArC,EAAgDC,UAAhD,CAAlB","sourcesContent":["\"use strict\";\n/**\n * @file 鼠标绘制工具库\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar react_1 = tslib_1.__importDefault(require(\"react\"));\nvar common_1 = require(\"../common\");\nvar requireScript_1 = require(\"../utils/requireScript\");\nvar WrapperHOC_1 = tslib_1.__importStar(require(\"../common/WrapperHOC\"));\nvar Map_1 = require(\"../Map\");\nvar eventsMap = [\n    'overlaycomplete',\n    'overlaycancel'\n];\nvar methodsMap = {\n    enableCalculate: ['enableCalculate', 'disableCalculate'],\n    enableSorption: ['enableSorption', 'disableSorption'],\n    enableGpc: ['enableGpc', 'disableGpc']\n};\nvar drawOptions = {\n    strokeColor: '#5E87DB',\n    fillColor: '#5E87DB',\n    strokeWeight: 2,\n    strokeOpacity: 1,\n    fillOpacity: 0.2\n};\nvar labelOptions = {\n    borderRadius: '2px',\n    background: '#FFFBCC',\n    border: '1px solid #E1E1E1',\n    color: '#703A04',\n    fontSize: '12px',\n    letterSpacing: '0',\n    padding: '5px'\n};\nvar DrawingManager = /** @class */ (function (_super) {\n    tslib_1.__extends(DrawingManager, _super);\n    function DrawingManager(props) {\n        var _this = _super.call(this, props) || this;\n        _this.el = react_1.default.createRef();\n        _this.options = [\n            'isOpen',\n            'drawingMode',\n            'enableDrawingTool',\n            'enableCalculate',\n            'enableSorption',\n            'enableGpc',\n            'enableLimit',\n            'sorptionDistance',\n            'limitOptions',\n            'drawingToolOptions',\n            'markerOptions',\n            'circleOptions',\n            'polylineOptions',\n            'polygonOptions',\n            'rectangleOptions',\n            'labelOptions'\n        ];\n        return _this;\n    }\n    DrawingManager.prototype.componentDidMount = function () {\n        this.initialize();\n    };\n    DrawingManager.prototype.componentWillUnmount = function () {\n        this.destroy();\n    };\n    DrawingManager.prototype.destroy = function () {\n        if (this.drawingmanager) {\n            this.drawingmanager.close();\n            // @ts-ignore\n            this.instance = this.drawingmanager = undefined;\n        }\n    };\n    DrawingManager.prototype.initialize = function () {\n        var _this = this;\n        var map = this.map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this.destroy();\n        var opts = this.getOptions();\n        var drawStyles = ['circleOptions', 'polylineOptions', 'polygonOptions', 'rectangleOptions'];\n        for (var i = 0; i < drawStyles.length; i++) {\n            var styl = drawStyles[i];\n            if (!opts[styl]) {\n                opts[styl] = drawOptions;\n            }\n        }\n        if (!opts.labelOptions) {\n            opts.labelOptions = labelOptions;\n        }\n        opts.drawingToolOptions.customContainer = this.el.current;\n        // 如果 BMapGLLib 已经加载过，会执行下面的\n        if (window.BMapGLLib && BMapGLLib.DrawingManager) {\n            this.instance = this.drawingmanager = new BMapGLLib.DrawingManager(map, opts);\n        }\n        // 如果第一次加载，会执行下面的\n        if (!window.BMapGLLib || !BMapGLLib.DrawingManager) {\n            requireScript_1.requireCss('//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css')\n                .then(function () { });\n            requireScript_1.requireScript('//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js')\n                .then(function () {\n                _this.instance = _this.drawingmanager = new BMapGLLib.DrawingManager(map, opts);\n                // 因为是异步加载，所以不会自动注册事件和执行方法，需要手动注册和执行\n                WrapperHOC_1.registerEvents(_this, _this.getInstance(_this), eventsMap);\n                WrapperHOC_1.toggleMethods(_this, _this.getInstance(_this), methodsMap);\n            });\n        }\n    };\n    DrawingManager.prototype.render = function () {\n        return (react_1.default.createElement(\"div\", { className: \"react-bmapgl-drawingmanager\", ref: this.el, style: this.props.style }));\n    };\n    DrawingManager.contextType = Map_1.MapContext;\n    return DrawingManager;\n}(common_1.Component));\nDrawingManager.defaultProps = {\n    isOpen: false,\n    enableDrawingTool: true,\n    enableCalculate: false,\n    enableSorption: false,\n    enableGpc: false,\n    enableLimit: false,\n    sorptionDistance: 20,\n    limitOptions: {\n        area: 50000000,\n        distance: 30000\n    },\n    drawingToolOptions: {},\n    style: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        width: 360\n    }\n};\n/**\n * 用来在地图上通过鼠标绘制覆盖物，该组件属于不属于原生JSAPI，属于开源工具库[BMapGLLib](https://github.com/huiyan-fe/BMapGLLib)\n * @visibleName DrawingManager 鼠标绘制工具\n */\nexports.default = WrapperHOC_1.default(DrawingManager, eventsMap, methodsMap);\n"]},"metadata":{},"sourceType":"script"}