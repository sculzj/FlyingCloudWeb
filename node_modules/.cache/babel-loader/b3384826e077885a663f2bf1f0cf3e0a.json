{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { isString, indexOf, each, bind, isArray, isDom } from 'zrender/lib/core/util';\nimport { toHex } from 'zrender/lib/tool/color';\nimport { normalizeEvent } from 'zrender/lib/core/event';\nimport { transformLocalCoord } from 'zrender/lib/core/dom';\nimport env from 'zrender/lib/core/env';\nimport { convertToColorString, toCamelCase, normalizeCssArray } from '../../util/format';\nimport { shouldTooltipConfine, toCSSVendorPrefix, getComputedStyle, TRANSFORM_VENDOR, TRANSITION_VENDOR } from './helper';\nimport { getPaddingFromTooltipModel } from './tooltipMarkup';\n/* global document, window */\n\nvar CSS_TRANSITION_VENDOR = toCSSVendorPrefix(TRANSITION_VENDOR, 'transition');\nvar CSS_TRANSFORM_VENDOR = toCSSVendorPrefix(TRANSFORM_VENDOR, 'transform'); // eslint-disable-next-line\n\nvar gCssText = \"position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;\" + (env.transform3dSupported ? 'will-change:transform;' : '');\n\nfunction mirrorPos(pos) {\n  pos = pos === 'left' ? 'right' : pos === 'right' ? 'left' : pos === 'top' ? 'bottom' : 'top';\n  return pos;\n}\n\nfunction assembleArrow(backgroundColor, borderColor, arrowPosition) {\n  if (!isString(arrowPosition) || arrowPosition === 'inside') {\n    return '';\n  }\n\n  borderColor = convertToColorString(borderColor);\n  var arrowPos = mirrorPos(arrowPosition);\n  var positionStyle = arrowPos + \":-6px;\";\n  var transformStyle = CSS_TRANSFORM_VENDOR + ':';\n\n  if (indexOf(['left', 'right'], arrowPos) > -1) {\n    positionStyle += 'top:50%';\n    transformStyle += \"translateY(-50%) rotate(\" + (arrowPos === 'left' ? -225 : -45) + \"deg)\";\n  } else {\n    positionStyle += 'left:50%';\n    transformStyle += \"translateX(-50%) rotate(\" + (arrowPos === 'top' ? 225 : 45) + \"deg)\";\n  }\n\n  var borderStyle = borderColor + \" solid 1px;\";\n  var styleCss = ['position:absolute;width:10px;height:10px;', positionStyle + \";\" + transformStyle + \";\", \"border-bottom:\" + borderStyle, \"border-right:\" + borderStyle, \"background-color:\" + backgroundColor + \";\", 'box-shadow:8px 8px 16px -3px #000;'];\n  return \"<div style=\\\"\" + styleCss.join('') + \"\\\"></div>\";\n}\n\nfunction assembleTransition(duration, onlyFade) {\n  var transitionCurve = 'cubic-bezier(0.23,1,0.32,1)';\n  var transitionOption = \" \" + duration / 2 + \"s \" + transitionCurve;\n  var transitionText = \"opacity\" + transitionOption + \",visibility\" + transitionOption;\n\n  if (!onlyFade) {\n    transitionOption = \" \" + duration + \"s \" + transitionCurve;\n    transitionText += env.transformSupported ? \",\" + TRANSFORM_VENDOR + transitionOption : \",left\" + transitionOption + \",top\" + transitionOption;\n  }\n\n  return CSS_TRANSITION_VENDOR + ':' + transitionText;\n}\n\nfunction assembleTransform(el, x, y, toString) {\n  // If using float on style, the final width of the dom might\n  // keep changing slightly while mouse move. So `toFixed(0)` them.\n  var x0;\n  var y0; // not support transform, use `left` and `top` instead.\n\n  if (!env.transformSupported) {\n    x0 = x.toFixed(0);\n    y0 = y.toFixed(0);\n    return toString ? \"top:\" + y0 + \"px;left:\" + x0 + \"px;\" : [['top', y0 + \"px\"], ['left', x0 + \"px\"]];\n  } // support transform\n  // FIXME: the padding of parent element will affect the position of tooltip\n\n\n  var stl = getComputedStyle(el.parentElement);\n  x0 = (x - parseInt(stl.paddingLeft, 10)).toFixed(0);\n  y0 = (y - parseInt(stl.paddingTop, 10)).toFixed(0);\n  var is3d = env.transform3dSupported;\n  var translate = \"translate\" + (is3d ? '3d' : '') + \"(\" + x0 + \"px,\" + y0 + \"px\" + (is3d ? ',0' : '') + \")\";\n  return toString ? CSS_TRANSFORM_VENDOR + ':' + translate + ';' : [[TRANSFORM_VENDOR, translate]];\n}\n/**\n * @param {Object} textStyle\n * @return {string}\n * @inner\n */\n\n\nfunction assembleFont(textStyleModel) {\n  var cssText = [];\n  var fontSize = textStyleModel.get('fontSize');\n  var color = textStyleModel.getTextColor();\n  color && cssText.push('color:' + color);\n  cssText.push('font:' + textStyleModel.getFont());\n  fontSize // @ts-ignore, leave it to the tooltip refactor.\n  && cssText.push('line-height:' + Math.round(fontSize * 3 / 2) + 'px');\n  var shadowColor = textStyleModel.get('textShadowColor');\n  var shadowBlur = textStyleModel.get('textShadowBlur') || 0;\n  var shadowOffsetX = textStyleModel.get('textShadowOffsetX') || 0;\n  var shadowOffsetY = textStyleModel.get('textShadowOffsetY') || 0;\n  shadowColor && shadowBlur && cssText.push('text-shadow:' + shadowOffsetX + 'px ' + shadowOffsetY + 'px ' + shadowBlur + 'px ' + shadowColor);\n  each(['decoration', 'align'], function (name) {\n    var val = textStyleModel.get(name);\n    val && cssText.push('text-' + name + ':' + val);\n  });\n  return cssText.join(';');\n}\n\nfunction assembleCssText(tooltipModel, enableTransition, onlyFade) {\n  var cssText = [];\n  var transitionDuration = tooltipModel.get('transitionDuration');\n  var backgroundColor = tooltipModel.get('backgroundColor');\n  var shadowBlur = tooltipModel.get('shadowBlur');\n  var shadowColor = tooltipModel.get('shadowColor');\n  var shadowOffsetX = tooltipModel.get('shadowOffsetX');\n  var shadowOffsetY = tooltipModel.get('shadowOffsetY');\n  var textStyleModel = tooltipModel.getModel('textStyle');\n  var padding = getPaddingFromTooltipModel(tooltipModel, 'html');\n  var boxShadow = shadowOffsetX + \"px \" + shadowOffsetY + \"px \" + shadowBlur + \"px \" + shadowColor;\n  cssText.push('box-shadow:' + boxShadow); // Animation transition. Do not animate when transitionDuration is 0.\n\n  enableTransition && transitionDuration && cssText.push(assembleTransition(transitionDuration, onlyFade));\n\n  if (backgroundColor) {\n    if (env.canvasSupported) {\n      cssText.push('background-color:' + backgroundColor);\n    } else {\n      // for ie\n      cssText.push('background-color:#' + toHex(backgroundColor));\n      cssText.push('filter:alpha(opacity=70)');\n    }\n  } // Border style\n\n\n  each(['width', 'color', 'radius'], function (name) {\n    var borderName = 'border-' + name;\n    var camelCase = toCamelCase(borderName);\n    var val = tooltipModel.get(camelCase);\n    val != null && cssText.push(borderName + ':' + val + (name === 'color' ? '' : 'px'));\n  }); // Text style\n\n  cssText.push(assembleFont(textStyleModel)); // Padding\n\n  if (padding != null) {\n    cssText.push('padding:' + normalizeCssArray(padding).join('px ') + 'px');\n  }\n\n  return cssText.join(';') + ';';\n} // If not able to make, do not modify the input `out`.\n\n\nfunction makeStyleCoord(out, zr, appendToBody, zrX, zrY) {\n  var zrPainter = zr && zr.painter;\n\n  if (appendToBody) {\n    var zrViewportRoot = zrPainter && zrPainter.getViewportRoot();\n\n    if (zrViewportRoot) {\n      // Some APPs might use scale on body, so we support CSS transform here.\n      transformLocalCoord(out, zrViewportRoot, document.body, zrX, zrY);\n    }\n  } else {\n    out[0] = zrX;\n    out[1] = zrY; // xy should be based on canvas root. But tooltipContent is\n    // the sibling of canvas root. So padding of ec container\n    // should be considered here.\n\n    var viewportRootOffset = zrPainter && zrPainter.getViewportRootOffset();\n\n    if (viewportRootOffset) {\n      out[0] += viewportRootOffset.offsetLeft;\n      out[1] += viewportRootOffset.offsetTop;\n    }\n  }\n\n  out[2] = out[0] / zr.getWidth();\n  out[3] = out[1] / zr.getHeight();\n}\n\nvar TooltipHTMLContent =\n/** @class */\nfunction () {\n  function TooltipHTMLContent(container, api, opt) {\n    this._show = false;\n    this._styleCoord = [0, 0, 0, 0];\n    this._enterable = true;\n    this._firstShow = true;\n    this._longHide = true;\n\n    if (env.wxa) {\n      return null;\n    }\n\n    var el = document.createElement('div'); // TODO: TYPE\n\n    el.domBelongToZr = true;\n    this.el = el;\n    var zr = this._zr = api.getZr();\n    var appendToBody = this._appendToBody = opt && opt.appendToBody;\n    makeStyleCoord(this._styleCoord, zr, appendToBody, api.getWidth() / 2, api.getHeight() / 2);\n\n    if (appendToBody) {\n      document.body.appendChild(el);\n    } else {\n      // PENDING\n      container.prepend(el);\n    }\n\n    this._container = container; // FIXME\n    // Is it needed to trigger zr event manually if\n    // the browser do not support `pointer-events: none`.\n\n    var self = this;\n\n    el.onmouseenter = function () {\n      // clear the timeout in hideLater and keep showing tooltip\n      if (self._enterable) {\n        clearTimeout(self._hideTimeout);\n        self._show = true;\n      }\n\n      self._inContent = true;\n    };\n\n    el.onmousemove = function (e) {\n      e = e || window.event;\n\n      if (!self._enterable) {\n        // `pointer-events: none` is set to tooltip content div\n        // if `enterable` is set as `false`, and `el.onmousemove`\n        // can not be triggered. But in browser that do not\n        // support `pointer-events`, we need to do this:\n        // Try trigger zrender event to avoid mouse\n        // in and out shape too frequently\n        var handler = zr.handler;\n        var zrViewportRoot = zr.painter.getViewportRoot();\n        normalizeEvent(zrViewportRoot, e, true);\n        handler.dispatch('mousemove', e);\n      }\n    };\n\n    el.onmouseleave = function () {\n      // set `_inContent` to `false` before `hideLater`\n      self._inContent = false;\n\n      if (self._enterable) {\n        if (self._show) {\n          self.hideLater(self._hideDelay);\n        }\n      }\n    };\n  }\n  /**\n   * Update when tooltip is rendered\n   */\n\n\n  TooltipHTMLContent.prototype.update = function (tooltipModel) {\n    // FIXME\n    // Move this logic to ec main?\n    var container = this._container;\n    var position = getComputedStyle(container, 'position');\n    var domStyle = container.style;\n\n    if (domStyle.position !== 'absolute' && position !== 'absolute') {\n      domStyle.position = 'relative';\n    } // move tooltip if chart resized\n\n\n    var alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    alwaysShowContent && this._moveIfResized(); // update className\n\n    this.el.className = tooltipModel.get('className') || ''; // Hide the tooltip\n    // PENDING\n    // this.hide();\n  };\n\n  TooltipHTMLContent.prototype.show = function (tooltipModel, nearPointColor) {\n    clearTimeout(this._hideTimeout);\n    clearTimeout(this._longHideTimeout);\n    var el = this.el;\n    var style = el.style;\n    var styleCoord = this._styleCoord;\n\n    if (!el.innerHTML) {\n      style.display = 'none';\n    } else {\n      style.cssText = gCssText + assembleCssText(tooltipModel, !this._firstShow, this._longHide) // initial transform\n      + assembleTransform(el, styleCoord[0], styleCoord[1], true) + (\"border-color:\" + convertToColorString(nearPointColor) + \";\") + (tooltipModel.get('extraCssText') || '') // If mouse occasionally move over the tooltip, a mouseout event will be\n      // triggered by canvas, and cause some unexpectable result like dragging\n      // stop, \"unfocusAdjacency\". Here `pointer-events: none` is used to solve\n      // it. Although it is not supported by IE8~IE10, fortunately it is a rare\n      // scenario.\n      + (\";pointer-event:\" + (this._enterable ? 'auto' : 'none'));\n    }\n\n    this._show = true;\n    this._firstShow = false;\n    this._longHide = false;\n  };\n\n  TooltipHTMLContent.prototype.setContent = function (content, markers, tooltipModel, borderColor, arrowPosition) {\n    if (content == null) {\n      return;\n    }\n\n    var el = this.el;\n\n    if (isString(arrowPosition) && tooltipModel.get('trigger') === 'item' && !shouldTooltipConfine(tooltipModel)) {\n      content += assembleArrow(tooltipModel.get('backgroundColor'), borderColor, arrowPosition);\n    }\n\n    if (isString(content)) {\n      el.innerHTML = content;\n    } else if (content) {\n      // Clear previous\n      el.innerHTML = '';\n\n      if (!isArray(content)) {\n        content = [content];\n      }\n\n      for (var i = 0; i < content.length; i++) {\n        if (isDom(content[i]) && content[i].parentNode !== el) {\n          el.appendChild(content[i]);\n        }\n      }\n    }\n  };\n\n  TooltipHTMLContent.prototype.setEnterable = function (enterable) {\n    this._enterable = enterable;\n  };\n\n  TooltipHTMLContent.prototype.getSize = function () {\n    var el = this.el;\n    return [el.clientWidth, el.clientHeight];\n  };\n\n  TooltipHTMLContent.prototype.moveTo = function (zrX, zrY) {\n    var styleCoord = this._styleCoord;\n    makeStyleCoord(styleCoord, this._zr, this._appendToBody, zrX, zrY);\n\n    if (styleCoord[0] != null && styleCoord[1] != null) {\n      var style_1 = this.el.style;\n      var transforms = assembleTransform(this.el, styleCoord[0], styleCoord[1]);\n      each(transforms, function (transform) {\n        style_1[transform[0]] = transform[1];\n      });\n    }\n  };\n  /**\n   * when `alwaysShowContent` is true,\n   * move the tooltip after chart resized\n   */\n\n\n  TooltipHTMLContent.prototype._moveIfResized = function () {\n    // The ratio of left to width\n    var ratioX = this._styleCoord[2]; // The ratio of top to height\n\n    var ratioY = this._styleCoord[3];\n    this.moveTo(ratioX * this._zr.getWidth(), ratioY * this._zr.getHeight());\n  };\n\n  TooltipHTMLContent.prototype.hide = function () {\n    var _this = this;\n\n    var style = this.el.style;\n    style.visibility = 'hidden';\n    style.opacity = '0';\n    env.transform3dSupported && (style.willChange = '');\n    this._show = false;\n    this._longHideTimeout = setTimeout(function () {\n      return _this._longHide = true;\n    }, 500);\n  };\n\n  TooltipHTMLContent.prototype.hideLater = function (time) {\n    if (this._show && !(this._inContent && this._enterable)) {\n      if (time) {\n        this._hideDelay = time; // Set show false to avoid invoke hideLater multiple times\n\n        this._show = false;\n        this._hideTimeout = setTimeout(bind(this.hide, this), time);\n      } else {\n        this.hide();\n      }\n    }\n  };\n\n  TooltipHTMLContent.prototype.isShow = function () {\n    return this._show;\n  };\n\n  TooltipHTMLContent.prototype.dispose = function () {\n    this.el.parentNode.removeChild(this.el);\n  };\n\n  TooltipHTMLContent.prototype.getOuterSize = function () {\n    var width = this.el.clientWidth;\n    var height = this.el.clientHeight; // Consider browser compatibility.\n    // IE8 does not support getComputedStyle.\n\n    var stl = getComputedStyle(this.el);\n\n    if (stl) {\n      width += parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n      height += parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n    }\n\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  return TooltipHTMLContent;\n}();\n\nexport default TooltipHTMLContent;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/echarts/lib/component/tooltip/TooltipHTMLContent.js"],"names":["isString","indexOf","each","bind","isArray","isDom","toHex","normalizeEvent","transformLocalCoord","env","convertToColorString","toCamelCase","normalizeCssArray","shouldTooltipConfine","toCSSVendorPrefix","getComputedStyle","TRANSFORM_VENDOR","TRANSITION_VENDOR","getPaddingFromTooltipModel","CSS_TRANSITION_VENDOR","CSS_TRANSFORM_VENDOR","gCssText","transform3dSupported","mirrorPos","pos","assembleArrow","backgroundColor","borderColor","arrowPosition","arrowPos","positionStyle","transformStyle","borderStyle","styleCss","join","assembleTransition","duration","onlyFade","transitionCurve","transitionOption","transitionText","transformSupported","assembleTransform","el","x","y","toString","x0","y0","toFixed","stl","parentElement","parseInt","paddingLeft","paddingTop","is3d","translate","assembleFont","textStyleModel","cssText","fontSize","get","color","getTextColor","push","getFont","Math","round","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","name","val","assembleCssText","tooltipModel","enableTransition","transitionDuration","getModel","padding","boxShadow","canvasSupported","borderName","camelCase","makeStyleCoord","out","zr","appendToBody","zrX","zrY","zrPainter","painter","zrViewportRoot","getViewportRoot","document","body","viewportRootOffset","getViewportRootOffset","offsetLeft","offsetTop","getWidth","getHeight","TooltipHTMLContent","container","api","opt","_show","_styleCoord","_enterable","_firstShow","_longHide","wxa","createElement","domBelongToZr","_zr","getZr","_appendToBody","appendChild","prepend","_container","self","onmouseenter","clearTimeout","_hideTimeout","_inContent","onmousemove","e","window","event","handler","dispatch","onmouseleave","hideLater","_hideDelay","prototype","update","position","domStyle","style","alwaysShowContent","_moveIfResized","className","show","nearPointColor","_longHideTimeout","styleCoord","innerHTML","display","setContent","content","markers","i","length","parentNode","setEnterable","enterable","getSize","clientWidth","clientHeight","moveTo","style_1","transforms","transform","ratioX","ratioY","hide","_this","visibility","opacity","willChange","setTimeout","time","isShow","dispose","removeChild","getOuterSize","width","height","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { isString, indexOf, each, bind, isArray, isDom } from 'zrender/lib/core/util';\nimport { toHex } from 'zrender/lib/tool/color';\nimport { normalizeEvent } from 'zrender/lib/core/event';\nimport { transformLocalCoord } from 'zrender/lib/core/dom';\nimport env from 'zrender/lib/core/env';\nimport { convertToColorString, toCamelCase, normalizeCssArray } from '../../util/format';\nimport { shouldTooltipConfine, toCSSVendorPrefix, getComputedStyle, TRANSFORM_VENDOR, TRANSITION_VENDOR } from './helper';\nimport { getPaddingFromTooltipModel } from './tooltipMarkup';\n/* global document, window */\n\nvar CSS_TRANSITION_VENDOR = toCSSVendorPrefix(TRANSITION_VENDOR, 'transition');\nvar CSS_TRANSFORM_VENDOR = toCSSVendorPrefix(TRANSFORM_VENDOR, 'transform'); // eslint-disable-next-line\n\nvar gCssText = \"position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;\" + (env.transform3dSupported ? 'will-change:transform;' : '');\n\nfunction mirrorPos(pos) {\n  pos = pos === 'left' ? 'right' : pos === 'right' ? 'left' : pos === 'top' ? 'bottom' : 'top';\n  return pos;\n}\n\nfunction assembleArrow(backgroundColor, borderColor, arrowPosition) {\n  if (!isString(arrowPosition) || arrowPosition === 'inside') {\n    return '';\n  }\n\n  borderColor = convertToColorString(borderColor);\n  var arrowPos = mirrorPos(arrowPosition);\n  var positionStyle = arrowPos + \":-6px;\";\n  var transformStyle = CSS_TRANSFORM_VENDOR + ':';\n\n  if (indexOf(['left', 'right'], arrowPos) > -1) {\n    positionStyle += 'top:50%';\n    transformStyle += \"translateY(-50%) rotate(\" + (arrowPos === 'left' ? -225 : -45) + \"deg)\";\n  } else {\n    positionStyle += 'left:50%';\n    transformStyle += \"translateX(-50%) rotate(\" + (arrowPos === 'top' ? 225 : 45) + \"deg)\";\n  }\n\n  var borderStyle = borderColor + \" solid 1px;\";\n  var styleCss = ['position:absolute;width:10px;height:10px;', positionStyle + \";\" + transformStyle + \";\", \"border-bottom:\" + borderStyle, \"border-right:\" + borderStyle, \"background-color:\" + backgroundColor + \";\", 'box-shadow:8px 8px 16px -3px #000;'];\n  return \"<div style=\\\"\" + styleCss.join('') + \"\\\"></div>\";\n}\n\nfunction assembleTransition(duration, onlyFade) {\n  var transitionCurve = 'cubic-bezier(0.23,1,0.32,1)';\n  var transitionOption = \" \" + duration / 2 + \"s \" + transitionCurve;\n  var transitionText = \"opacity\" + transitionOption + \",visibility\" + transitionOption;\n\n  if (!onlyFade) {\n    transitionOption = \" \" + duration + \"s \" + transitionCurve;\n    transitionText += env.transformSupported ? \",\" + TRANSFORM_VENDOR + transitionOption : \",left\" + transitionOption + \",top\" + transitionOption;\n  }\n\n  return CSS_TRANSITION_VENDOR + ':' + transitionText;\n}\n\nfunction assembleTransform(el, x, y, toString) {\n  // If using float on style, the final width of the dom might\n  // keep changing slightly while mouse move. So `toFixed(0)` them.\n  var x0;\n  var y0; // not support transform, use `left` and `top` instead.\n\n  if (!env.transformSupported) {\n    x0 = x.toFixed(0);\n    y0 = y.toFixed(0);\n    return toString ? \"top:\" + y0 + \"px;left:\" + x0 + \"px;\" : [['top', y0 + \"px\"], ['left', x0 + \"px\"]];\n  } // support transform\n  // FIXME: the padding of parent element will affect the position of tooltip\n\n\n  var stl = getComputedStyle(el.parentElement);\n  x0 = (x - parseInt(stl.paddingLeft, 10)).toFixed(0);\n  y0 = (y - parseInt(stl.paddingTop, 10)).toFixed(0);\n  var is3d = env.transform3dSupported;\n  var translate = \"translate\" + (is3d ? '3d' : '') + \"(\" + x0 + \"px,\" + y0 + \"px\" + (is3d ? ',0' : '') + \")\";\n  return toString ? CSS_TRANSFORM_VENDOR + ':' + translate + ';' : [[TRANSFORM_VENDOR, translate]];\n}\n/**\n * @param {Object} textStyle\n * @return {string}\n * @inner\n */\n\n\nfunction assembleFont(textStyleModel) {\n  var cssText = [];\n  var fontSize = textStyleModel.get('fontSize');\n  var color = textStyleModel.getTextColor();\n  color && cssText.push('color:' + color);\n  cssText.push('font:' + textStyleModel.getFont());\n  fontSize // @ts-ignore, leave it to the tooltip refactor.\n  && cssText.push('line-height:' + Math.round(fontSize * 3 / 2) + 'px');\n  var shadowColor = textStyleModel.get('textShadowColor');\n  var shadowBlur = textStyleModel.get('textShadowBlur') || 0;\n  var shadowOffsetX = textStyleModel.get('textShadowOffsetX') || 0;\n  var shadowOffsetY = textStyleModel.get('textShadowOffsetY') || 0;\n  shadowColor && shadowBlur && cssText.push('text-shadow:' + shadowOffsetX + 'px ' + shadowOffsetY + 'px ' + shadowBlur + 'px ' + shadowColor);\n  each(['decoration', 'align'], function (name) {\n    var val = textStyleModel.get(name);\n    val && cssText.push('text-' + name + ':' + val);\n  });\n  return cssText.join(';');\n}\n\nfunction assembleCssText(tooltipModel, enableTransition, onlyFade) {\n  var cssText = [];\n  var transitionDuration = tooltipModel.get('transitionDuration');\n  var backgroundColor = tooltipModel.get('backgroundColor');\n  var shadowBlur = tooltipModel.get('shadowBlur');\n  var shadowColor = tooltipModel.get('shadowColor');\n  var shadowOffsetX = tooltipModel.get('shadowOffsetX');\n  var shadowOffsetY = tooltipModel.get('shadowOffsetY');\n  var textStyleModel = tooltipModel.getModel('textStyle');\n  var padding = getPaddingFromTooltipModel(tooltipModel, 'html');\n  var boxShadow = shadowOffsetX + \"px \" + shadowOffsetY + \"px \" + shadowBlur + \"px \" + shadowColor;\n  cssText.push('box-shadow:' + boxShadow); // Animation transition. Do not animate when transitionDuration is 0.\n\n  enableTransition && transitionDuration && cssText.push(assembleTransition(transitionDuration, onlyFade));\n\n  if (backgroundColor) {\n    if (env.canvasSupported) {\n      cssText.push('background-color:' + backgroundColor);\n    } else {\n      // for ie\n      cssText.push('background-color:#' + toHex(backgroundColor));\n      cssText.push('filter:alpha(opacity=70)');\n    }\n  } // Border style\n\n\n  each(['width', 'color', 'radius'], function (name) {\n    var borderName = 'border-' + name;\n    var camelCase = toCamelCase(borderName);\n    var val = tooltipModel.get(camelCase);\n    val != null && cssText.push(borderName + ':' + val + (name === 'color' ? '' : 'px'));\n  }); // Text style\n\n  cssText.push(assembleFont(textStyleModel)); // Padding\n\n  if (padding != null) {\n    cssText.push('padding:' + normalizeCssArray(padding).join('px ') + 'px');\n  }\n\n  return cssText.join(';') + ';';\n} // If not able to make, do not modify the input `out`.\n\n\nfunction makeStyleCoord(out, zr, appendToBody, zrX, zrY) {\n  var zrPainter = zr && zr.painter;\n\n  if (appendToBody) {\n    var zrViewportRoot = zrPainter && zrPainter.getViewportRoot();\n\n    if (zrViewportRoot) {\n      // Some APPs might use scale on body, so we support CSS transform here.\n      transformLocalCoord(out, zrViewportRoot, document.body, zrX, zrY);\n    }\n  } else {\n    out[0] = zrX;\n    out[1] = zrY; // xy should be based on canvas root. But tooltipContent is\n    // the sibling of canvas root. So padding of ec container\n    // should be considered here.\n\n    var viewportRootOffset = zrPainter && zrPainter.getViewportRootOffset();\n\n    if (viewportRootOffset) {\n      out[0] += viewportRootOffset.offsetLeft;\n      out[1] += viewportRootOffset.offsetTop;\n    }\n  }\n\n  out[2] = out[0] / zr.getWidth();\n  out[3] = out[1] / zr.getHeight();\n}\n\nvar TooltipHTMLContent =\n/** @class */\nfunction () {\n  function TooltipHTMLContent(container, api, opt) {\n    this._show = false;\n    this._styleCoord = [0, 0, 0, 0];\n    this._enterable = true;\n    this._firstShow = true;\n    this._longHide = true;\n\n    if (env.wxa) {\n      return null;\n    }\n\n    var el = document.createElement('div'); // TODO: TYPE\n\n    el.domBelongToZr = true;\n    this.el = el;\n    var zr = this._zr = api.getZr();\n    var appendToBody = this._appendToBody = opt && opt.appendToBody;\n    makeStyleCoord(this._styleCoord, zr, appendToBody, api.getWidth() / 2, api.getHeight() / 2);\n\n    if (appendToBody) {\n      document.body.appendChild(el);\n    } else {\n      // PENDING\n      container.prepend(el);\n    }\n\n    this._container = container; // FIXME\n    // Is it needed to trigger zr event manually if\n    // the browser do not support `pointer-events: none`.\n\n    var self = this;\n\n    el.onmouseenter = function () {\n      // clear the timeout in hideLater and keep showing tooltip\n      if (self._enterable) {\n        clearTimeout(self._hideTimeout);\n        self._show = true;\n      }\n\n      self._inContent = true;\n    };\n\n    el.onmousemove = function (e) {\n      e = e || window.event;\n\n      if (!self._enterable) {\n        // `pointer-events: none` is set to tooltip content div\n        // if `enterable` is set as `false`, and `el.onmousemove`\n        // can not be triggered. But in browser that do not\n        // support `pointer-events`, we need to do this:\n        // Try trigger zrender event to avoid mouse\n        // in and out shape too frequently\n        var handler = zr.handler;\n        var zrViewportRoot = zr.painter.getViewportRoot();\n        normalizeEvent(zrViewportRoot, e, true);\n        handler.dispatch('mousemove', e);\n      }\n    };\n\n    el.onmouseleave = function () {\n      // set `_inContent` to `false` before `hideLater`\n      self._inContent = false;\n\n      if (self._enterable) {\n        if (self._show) {\n          self.hideLater(self._hideDelay);\n        }\n      }\n    };\n  }\n  /**\n   * Update when tooltip is rendered\n   */\n\n\n  TooltipHTMLContent.prototype.update = function (tooltipModel) {\n    // FIXME\n    // Move this logic to ec main?\n    var container = this._container;\n    var position = getComputedStyle(container, 'position');\n    var domStyle = container.style;\n\n    if (domStyle.position !== 'absolute' && position !== 'absolute') {\n      domStyle.position = 'relative';\n    } // move tooltip if chart resized\n\n\n    var alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    alwaysShowContent && this._moveIfResized(); // update className\n\n    this.el.className = tooltipModel.get('className') || ''; // Hide the tooltip\n    // PENDING\n    // this.hide();\n  };\n\n  TooltipHTMLContent.prototype.show = function (tooltipModel, nearPointColor) {\n    clearTimeout(this._hideTimeout);\n    clearTimeout(this._longHideTimeout);\n    var el = this.el;\n    var style = el.style;\n    var styleCoord = this._styleCoord;\n\n    if (!el.innerHTML) {\n      style.display = 'none';\n    } else {\n      style.cssText = gCssText + assembleCssText(tooltipModel, !this._firstShow, this._longHide) // initial transform\n      + assembleTransform(el, styleCoord[0], styleCoord[1], true) + (\"border-color:\" + convertToColorString(nearPointColor) + \";\") + (tooltipModel.get('extraCssText') || '') // If mouse occasionally move over the tooltip, a mouseout event will be\n      // triggered by canvas, and cause some unexpectable result like dragging\n      // stop, \"unfocusAdjacency\". Here `pointer-events: none` is used to solve\n      // it. Although it is not supported by IE8~IE10, fortunately it is a rare\n      // scenario.\n      + (\";pointer-event:\" + (this._enterable ? 'auto' : 'none'));\n    }\n\n    this._show = true;\n    this._firstShow = false;\n    this._longHide = false;\n  };\n\n  TooltipHTMLContent.prototype.setContent = function (content, markers, tooltipModel, borderColor, arrowPosition) {\n    if (content == null) {\n      return;\n    }\n\n    var el = this.el;\n\n    if (isString(arrowPosition) && tooltipModel.get('trigger') === 'item' && !shouldTooltipConfine(tooltipModel)) {\n      content += assembleArrow(tooltipModel.get('backgroundColor'), borderColor, arrowPosition);\n    }\n\n    if (isString(content)) {\n      el.innerHTML = content;\n    } else if (content) {\n      // Clear previous\n      el.innerHTML = '';\n\n      if (!isArray(content)) {\n        content = [content];\n      }\n\n      for (var i = 0; i < content.length; i++) {\n        if (isDom(content[i]) && content[i].parentNode !== el) {\n          el.appendChild(content[i]);\n        }\n      }\n    }\n  };\n\n  TooltipHTMLContent.prototype.setEnterable = function (enterable) {\n    this._enterable = enterable;\n  };\n\n  TooltipHTMLContent.prototype.getSize = function () {\n    var el = this.el;\n    return [el.clientWidth, el.clientHeight];\n  };\n\n  TooltipHTMLContent.prototype.moveTo = function (zrX, zrY) {\n    var styleCoord = this._styleCoord;\n    makeStyleCoord(styleCoord, this._zr, this._appendToBody, zrX, zrY);\n\n    if (styleCoord[0] != null && styleCoord[1] != null) {\n      var style_1 = this.el.style;\n      var transforms = assembleTransform(this.el, styleCoord[0], styleCoord[1]);\n      each(transforms, function (transform) {\n        style_1[transform[0]] = transform[1];\n      });\n    }\n  };\n  /**\n   * when `alwaysShowContent` is true,\n   * move the tooltip after chart resized\n   */\n\n\n  TooltipHTMLContent.prototype._moveIfResized = function () {\n    // The ratio of left to width\n    var ratioX = this._styleCoord[2]; // The ratio of top to height\n\n    var ratioY = this._styleCoord[3];\n    this.moveTo(ratioX * this._zr.getWidth(), ratioY * this._zr.getHeight());\n  };\n\n  TooltipHTMLContent.prototype.hide = function () {\n    var _this = this;\n\n    var style = this.el.style;\n    style.visibility = 'hidden';\n    style.opacity = '0';\n    env.transform3dSupported && (style.willChange = '');\n    this._show = false;\n    this._longHideTimeout = setTimeout(function () {\n      return _this._longHide = true;\n    }, 500);\n  };\n\n  TooltipHTMLContent.prototype.hideLater = function (time) {\n    if (this._show && !(this._inContent && this._enterable)) {\n      if (time) {\n        this._hideDelay = time; // Set show false to avoid invoke hideLater multiple times\n\n        this._show = false;\n        this._hideTimeout = setTimeout(bind(this.hide, this), time);\n      } else {\n        this.hide();\n      }\n    }\n  };\n\n  TooltipHTMLContent.prototype.isShow = function () {\n    return this._show;\n  };\n\n  TooltipHTMLContent.prototype.dispose = function () {\n    this.el.parentNode.removeChild(this.el);\n  };\n\n  TooltipHTMLContent.prototype.getOuterSize = function () {\n    var width = this.el.clientWidth;\n    var height = this.el.clientHeight; // Consider browser compatibility.\n    // IE8 does not support getComputedStyle.\n\n    var stl = getComputedStyle(this.el);\n\n    if (stl) {\n      width += parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n      height += parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n    }\n\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  return TooltipHTMLContent;\n}();\n\nexport default TooltipHTMLContent;"]},"metadata":{},"sourceType":"module"}