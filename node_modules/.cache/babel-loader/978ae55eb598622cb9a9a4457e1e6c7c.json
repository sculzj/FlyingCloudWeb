{"ast":null,"code":"\"use strict\";\n/**\n * @file mapvgl的view图层管理类\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ViewContext = void 0;\n\nvar tslib_1 = require(\"tslib\"); // @ts-ignore\n\n\nvar mapvgl_1 = require(\"mapvgl\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar common_1 = require(\"../common\");\n\nvar Map_1 = require(\"../Map\");\n\n;\nexports.ViewContext = react_1.default.createContext({\n  // We provide a default function for Context without provider\n  view: undefined\n});\n/**\n * 该组件将MapVGL的图层管理器使用`react`进行了一层封装。所有`<MapvglLayer>`组件需要作为该组件的子组件，文档参考[MapVGL图层管理器](https://mapv.baidu.com/gl/docs/View.html)\n * @visibleName MapvglView MapVGL图层管理器\n */\n\nvar MapvglView =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(MapvglView, _super);\n\n  function MapvglView(props) {\n    return _super.call(this, props) || this;\n  }\n\n  MapvglView.prototype.componentDidMount = function () {\n    this.initialize();\n    this.forceUpdate();\n  };\n\n  MapvglView.prototype.componentWillUnmount = function () {\n    if (this.view) {\n      this.view.destroy(); // @ts-ignore\n\n      this.view = null;\n    }\n  };\n\n  MapvglView.prototype.componentDidUpdate = function (prevProps) {\n    if (!this.map || !this.view) {\n      this.initialize();\n    }\n  };\n\n  MapvglView.prototype.initialize = function () {\n    var map = this.map = this.getMap();\n\n    if (!map || this.view) {\n      return;\n    }\n\n    if (!this.view) {\n      var effects_1 = [];\n      var simpleEffects = this.props.effects;\n\n      if (simpleEffects && simpleEffects.length) {\n        simpleEffects.forEach(function (name) {\n          if (name === 'bloom') {\n            effects_1.push(new mapvgl_1.BloomEffect());\n          } else if (name === 'bright') {\n            effects_1.push(new mapvgl_1.BrightEffect());\n          } else if (name === 'blur') {\n            effects_1.push(new mapvgl_1.BlurEffect());\n          }\n        });\n      }\n\n      this.view = new mapvgl_1.View({\n        effects: effects_1,\n        map: map\n      });\n    }\n  };\n  /**\n   * 在子元素props中附上view和map字段\n   * @return {string|Element} children with props\n   * @memberof MapvglView\n   */\n\n\n  MapvglView.prototype.renderChildren = function (children) {\n    var _this = this;\n\n    if (!children || !this.map || !this.view) {\n      return;\n    }\n\n    return react_1.default.Children.map(children, function (child) {\n      if (!child) {\n        return;\n      }\n\n      if (typeof child.type === 'string') {\n        return child;\n      } else {\n        return react_1.default.cloneElement(child, {\n          map: _this.map,\n          view: _this.view\n        });\n      }\n    });\n  };\n\n  MapvglView.prototype.render = function () {\n    return react_1.default.createElement(react_1.Fragment, null, react_1.default.createElement(exports.ViewContext.Provider, {\n      value: {\n        map: this.map,\n        view: this.view\n      }\n    }, this.renderChildren(this.props.children)));\n  };\n\n  MapvglView.contextType = Map_1.MapContext;\n  return MapvglView;\n}(common_1.Component);\n\nexports.default = MapvglView;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Layer/MapvglView.js"],"names":["Object","defineProperty","exports","value","ViewContext","tslib_1","require","mapvgl_1","react_1","__importStar","common_1","Map_1","default","createContext","view","undefined","MapvglView","_super","__extends","props","call","prototype","componentDidMount","initialize","forceUpdate","componentWillUnmount","destroy","componentDidUpdate","prevProps","map","getMap","effects_1","simpleEffects","effects","length","forEach","name","push","BloomEffect","BrightEffect","BlurEffect","View","renderChildren","children","_this","Children","child","type","cloneElement","render","createElement","Fragment","Provider","contextType","MapContext","Component"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @file mapvgl的view图层管理类\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ViewContext = void 0;\nvar tslib_1 = require(\"tslib\");\n// @ts-ignore\nvar mapvgl_1 = require(\"mapvgl\");\nvar react_1 = tslib_1.__importStar(require(\"react\"));\nvar common_1 = require(\"../common\");\nvar Map_1 = require(\"../Map\");\n;\nexports.ViewContext = react_1.default.createContext({\n    // We provide a default function for Context without provider\n    view: undefined\n});\n/**\n * 该组件将MapVGL的图层管理器使用`react`进行了一层封装。所有`<MapvglLayer>`组件需要作为该组件的子组件，文档参考[MapVGL图层管理器](https://mapv.baidu.com/gl/docs/View.html)\n * @visibleName MapvglView MapVGL图层管理器\n */\nvar MapvglView = /** @class */ (function (_super) {\n    tslib_1.__extends(MapvglView, _super);\n    function MapvglView(props) {\n        return _super.call(this, props) || this;\n    }\n    MapvglView.prototype.componentDidMount = function () {\n        this.initialize();\n        this.forceUpdate();\n    };\n    MapvglView.prototype.componentWillUnmount = function () {\n        if (this.view) {\n            this.view.destroy();\n            // @ts-ignore\n            this.view = null;\n        }\n    };\n    MapvglView.prototype.componentDidUpdate = function (prevProps) {\n        if (!this.map || !this.view) {\n            this.initialize();\n        }\n    };\n    MapvglView.prototype.initialize = function () {\n        var map = this.map = this.getMap();\n        if (!map || this.view) {\n            return;\n        }\n        if (!this.view) {\n            var effects_1 = [];\n            var simpleEffects = this.props.effects;\n            if (simpleEffects && simpleEffects.length) {\n                simpleEffects.forEach(function (name) {\n                    if (name === 'bloom') {\n                        effects_1.push(new mapvgl_1.BloomEffect());\n                    }\n                    else if (name === 'bright') {\n                        effects_1.push(new mapvgl_1.BrightEffect());\n                    }\n                    else if (name === 'blur') {\n                        effects_1.push(new mapvgl_1.BlurEffect());\n                    }\n                });\n            }\n            this.view = new mapvgl_1.View({\n                effects: effects_1,\n                map: map\n            });\n        }\n    };\n    /**\n     * 在子元素props中附上view和map字段\n     * @return {string|Element} children with props\n     * @memberof MapvglView\n     */\n    MapvglView.prototype.renderChildren = function (children) {\n        var _this = this;\n        if (!children || !this.map || !this.view) {\n            return;\n        }\n        return react_1.default.Children.map(children, function (child) {\n            if (!child) {\n                return;\n            }\n            if (typeof child.type === 'string') {\n                return child;\n            }\n            else {\n                return react_1.default.cloneElement(child, {\n                    map: _this.map,\n                    view: _this.view\n                });\n            }\n        });\n    };\n    MapvglView.prototype.render = function () {\n        return (react_1.default.createElement(react_1.Fragment, null,\n            react_1.default.createElement(exports.ViewContext.Provider, { value: {\n                    map: this.map,\n                    view: this.view\n                } }, this.renderChildren(this.props.children))));\n    };\n    MapvglView.contextType = Map_1.MapContext;\n    return MapvglView;\n}(common_1.Component));\nexports.default = MapvglView;\n"]},"metadata":{},"sourceType":"script"}