{"ast":null,"code":"\"use strict\";\n/**\n * @file 信息窗口\n * @author hedongran\n * @email hdr01@126.com\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar common_1 = require(\"../common\");\n\nvar WrapperHOC_1 = tslib_1.__importDefault(require(\"../common/WrapperHOC\"));\n\nvar react_dom_1 = require(\"react-dom\");\n\nvar Map_1 = require(\"../Map\");\n\n;\nvar eventsMap = ['close', 'open', 'maximize', 'restore', 'clickclose'];\nvar methodsMap = {\n  enableMaximize: ['enableMaximize', 'disableMaximize'],\n  enableAutoPan: ['enableAutoPan', 'disableAutoPan'],\n  enableCloseOnClick: ['enableCloseOnClick', 'disableCloseOnClick']\n};\n\nvar InfoWindow =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(InfoWindow, _super);\n\n  function InfoWindow(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.options = ['width', 'height', 'maxWidth', 'offset', 'title', 'enableMassClear'];\n    return _this;\n  }\n\n  InfoWindow.prototype.componentDidUpdate = function (prevProps) {\n    this.initialize();\n  };\n\n  InfoWindow.prototype.componentDidMount = function () {\n    this.initialize();\n  };\n\n  InfoWindow.prototype.componentWillUnmount = function () {\n    this.destroy();\n  };\n\n  InfoWindow.prototype.destroy = function () {\n    if (this.content) {\n      react_dom_1.unmountComponentAtNode(this.content);\n    }\n\n    if (this.infoWindow) {\n      this.map.closeInfoWindow(); // @ts-ignore\n\n      this.instance = this.infoWindow = undefined;\n    }\n  };\n\n  InfoWindow.prototype.initialize = function () {\n    var map = this.map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this.destroy();\n    var options = this.getOptions();\n    var position = this.parsePosition(this.props.position);\n    this.instance = this.infoWindow = new BMapGL.InfoWindow(this.props.text || '', options);\n    map.openInfoWindow(this.infoWindow, position);\n\n    if (this.props.children !== undefined) {\n      var content = this.content = document.createElement('div'); // @ts-ignore\n\n      react_dom_1.render(this.props.children, content);\n      this.infoWindow.setContent(content);\n    }\n  };\n\n  InfoWindow.prototype.parsePosition = function (position) {\n    var isMC = this.props.coordType === 'bd09mc';\n    var point;\n\n    if (position instanceof Array) {\n      point = new BMapGL.Point(position[0], position[1]);\n    } else if (position instanceof BMapGL.Point) {\n      point = position;\n    } else {\n      point = new BMapGL.Point(position.lng, position.lat);\n    }\n\n    if (isMC) {\n      point = BMapGL.Projection.convertMC2LL(point);\n    }\n\n    return point;\n  };\n\n  InfoWindow.prototype.render = function () {\n    return null;\n  };\n\n  InfoWindow.contextType = Map_1.MapContext;\n  return InfoWindow;\n}(common_1.Component);\n/**\n * defaultProps属性要放在外面，不然生成API文档时，没有默认值\n */\n\n\nInfoWindow.defaultProps = {};\n/**\n * 在地图上创建信息窗口，用于展示弹窗信息\n * @visibleName InfoWindow 信息窗口\n */\n\nexports.default = WrapperHOC_1.default(InfoWindow, eventsMap, methodsMap);","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/node_modules/react-bmapgl/Overlay/InfoWindow.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","common_1","WrapperHOC_1","__importDefault","react_dom_1","Map_1","eventsMap","methodsMap","enableMaximize","enableAutoPan","enableCloseOnClick","InfoWindow","_super","__extends","props","_this","call","options","prototype","componentDidUpdate","prevProps","initialize","componentDidMount","componentWillUnmount","destroy","content","unmountComponentAtNode","infoWindow","map","closeInfoWindow","instance","undefined","getMap","getOptions","position","parsePosition","BMapGL","text","openInfoWindow","children","document","createElement","render","setContent","isMC","coordType","point","Array","Point","lng","lat","Projection","convertMC2LL","contextType","MapContext","Component","defaultProps","default"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAIC,OAAO,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIE,YAAY,GAAGH,OAAO,CAACI,eAAR,CAAwBH,OAAO,CAAC,sBAAD,CAA/B,CAAnB;;AACA,IAAII,WAAW,GAAGJ,OAAO,CAAC,WAAD,CAAzB;;AACA,IAAIK,KAAK,GAAGL,OAAO,CAAC,QAAD,CAAnB;;AACA;AACA,IAAIM,SAAS,GAAG,CACZ,OADY,EAEZ,MAFY,EAGZ,UAHY,EAIZ,SAJY,EAKZ,YALY,CAAhB;AAOA,IAAIC,UAAU,GAAG;AACbC,EAAAA,cAAc,EAAE,CAAC,gBAAD,EAAmB,iBAAnB,CADH;AAEbC,EAAAA,aAAa,EAAE,CAAC,eAAD,EAAkB,gBAAlB,CAFF;AAGbC,EAAAA,kBAAkB,EAAE,CAAC,oBAAD,EAAuB,qBAAvB;AAHP,CAAjB;;AAKA,IAAIC,UAAU;AAAG;AAAe,UAAUC,MAAV,EAAkB;AAC9Cb,EAAAA,OAAO,CAACc,SAAR,CAAkBF,UAAlB,EAA8BC,MAA9B;;AACA,WAASD,UAAT,CAAoBG,KAApB,EAA2B;AACvB,QAAIC,KAAK,GAAGH,MAAM,CAACI,IAAP,CAAY,IAAZ,EAAkBF,KAAlB,KAA4B,IAAxC;;AACAC,IAAAA,KAAK,CAACE,OAAN,GAAgB,CACZ,OADY,EAEZ,QAFY,EAGZ,UAHY,EAIZ,QAJY,EAKZ,OALY,EAMZ,iBANY,CAAhB;AAQA,WAAOF,KAAP;AACH;;AACDJ,EAAAA,UAAU,CAACO,SAAX,CAAqBC,kBAArB,GAA0C,UAAUC,SAAV,EAAqB;AAC3D,SAAKC,UAAL;AACH,GAFD;;AAGAV,EAAAA,UAAU,CAACO,SAAX,CAAqBI,iBAArB,GAAyC,YAAY;AACjD,SAAKD,UAAL;AACH,GAFD;;AAGAV,EAAAA,UAAU,CAACO,SAAX,CAAqBK,oBAArB,GAA4C,YAAY;AACpD,SAAKC,OAAL;AACH,GAFD;;AAGAb,EAAAA,UAAU,CAACO,SAAX,CAAqBM,OAArB,GAA+B,YAAY;AACvC,QAAI,KAAKC,OAAT,EAAkB;AACdrB,MAAAA,WAAW,CAACsB,sBAAZ,CAAmC,KAAKD,OAAxC;AACH;;AACD,QAAI,KAAKE,UAAT,EAAqB;AACjB,WAAKC,GAAL,CAASC,eAAT,GADiB,CAEjB;;AACA,WAAKC,QAAL,GAAgB,KAAKH,UAAL,GAAkBI,SAAlC;AACH;AACJ,GATD;;AAUApB,EAAAA,UAAU,CAACO,SAAX,CAAqBG,UAArB,GAAkC,YAAY;AAC1C,QAAIO,GAAG,GAAG,KAAKA,GAAL,GAAW,KAAKI,MAAL,EAArB;;AACA,QAAI,CAACJ,GAAL,EAAU;AACN;AACH;;AACD,SAAKJ,OAAL;AACA,QAAIP,OAAO,GAAG,KAAKgB,UAAL,EAAd;AACA,QAAIC,QAAQ,GAAG,KAAKC,aAAL,CAAmB,KAAKrB,KAAL,CAAWoB,QAA9B,CAAf;AACA,SAAKJ,QAAL,GAAgB,KAAKH,UAAL,GAAkB,IAAIS,MAAM,CAACzB,UAAX,CAAsB,KAAKG,KAAL,CAAWuB,IAAX,IAAmB,EAAzC,EAA6CpB,OAA7C,CAAlC;AACAW,IAAAA,GAAG,CAACU,cAAJ,CAAmB,KAAKX,UAAxB,EAAoCO,QAApC;;AACA,QAAI,KAAKpB,KAAL,CAAWyB,QAAX,KAAwBR,SAA5B,EAAuC;AACnC,UAAIN,OAAO,GAAG,KAAKA,OAAL,GAAee,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAA7B,CADmC,CAEnC;;AACArC,MAAAA,WAAW,CAACsC,MAAZ,CAAmB,KAAK5B,KAAL,CAAWyB,QAA9B,EAAwCd,OAAxC;AACA,WAAKE,UAAL,CAAgBgB,UAAhB,CAA2BlB,OAA3B;AACH;AACJ,GAhBD;;AAiBAd,EAAAA,UAAU,CAACO,SAAX,CAAqBiB,aAArB,GAAqC,UAAUD,QAAV,EAAoB;AACrD,QAAIU,IAAI,GAAG,KAAK9B,KAAL,CAAW+B,SAAX,KAAyB,QAApC;AACA,QAAIC,KAAJ;;AACA,QAAIZ,QAAQ,YAAYa,KAAxB,EAA+B;AAC3BD,MAAAA,KAAK,GAAG,IAAIV,MAAM,CAACY,KAAX,CAAiBd,QAAQ,CAAC,CAAD,CAAzB,EAA8BA,QAAQ,CAAC,CAAD,CAAtC,CAAR;AACH,KAFD,MAGK,IAAIA,QAAQ,YAAYE,MAAM,CAACY,KAA/B,EAAsC;AACvCF,MAAAA,KAAK,GAAGZ,QAAR;AACH,KAFI,MAGA;AACDY,MAAAA,KAAK,GAAG,IAAIV,MAAM,CAACY,KAAX,CAAiBd,QAAQ,CAACe,GAA1B,EAA+Bf,QAAQ,CAACgB,GAAxC,CAAR;AACH;;AACD,QAAIN,IAAJ,EAAU;AACNE,MAAAA,KAAK,GAAGV,MAAM,CAACe,UAAP,CAAkBC,YAAlB,CAA+BN,KAA/B,CAAR;AACH;;AACD,WAAOA,KAAP;AACH,GAhBD;;AAiBAnC,EAAAA,UAAU,CAACO,SAAX,CAAqBwB,MAArB,GAA8B,YAAY;AACtC,WAAO,IAAP;AACH,GAFD;;AAGA/B,EAAAA,UAAU,CAAC0C,WAAX,GAAyBhD,KAAK,CAACiD,UAA/B;AACA,SAAO3C,UAAP;AACH,CAxE+B,CAwE9BV,QAAQ,CAACsD,SAxEqB,CAAhC;AAyEA;AACA;AACA;;;AACA5C,UAAU,CAAC6C,YAAX,GAA0B,EAA1B;AACA;AACA;AACA;AACA;;AACA3D,OAAO,CAAC4D,OAAR,GAAkBvD,YAAY,CAACuD,OAAb,CAAqB9C,UAArB,EAAiCL,SAAjC,EAA4CC,UAA5C,CAAlB","sourcesContent":["\"use strict\";\n/**\n * @file 信息窗口\n * @author hedongran\n * @email hdr01@126.com\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar common_1 = require(\"../common\");\nvar WrapperHOC_1 = tslib_1.__importDefault(require(\"../common/WrapperHOC\"));\nvar react_dom_1 = require(\"react-dom\");\nvar Map_1 = require(\"../Map\");\n;\nvar eventsMap = [\n    'close',\n    'open',\n    'maximize',\n    'restore',\n    'clickclose'\n];\nvar methodsMap = {\n    enableMaximize: ['enableMaximize', 'disableMaximize'],\n    enableAutoPan: ['enableAutoPan', 'disableAutoPan'],\n    enableCloseOnClick: ['enableCloseOnClick', 'disableCloseOnClick']\n};\nvar InfoWindow = /** @class */ (function (_super) {\n    tslib_1.__extends(InfoWindow, _super);\n    function InfoWindow(props) {\n        var _this = _super.call(this, props) || this;\n        _this.options = [\n            'width',\n            'height',\n            'maxWidth',\n            'offset',\n            'title',\n            'enableMassClear'\n        ];\n        return _this;\n    }\n    InfoWindow.prototype.componentDidUpdate = function (prevProps) {\n        this.initialize();\n    };\n    InfoWindow.prototype.componentDidMount = function () {\n        this.initialize();\n    };\n    InfoWindow.prototype.componentWillUnmount = function () {\n        this.destroy();\n    };\n    InfoWindow.prototype.destroy = function () {\n        if (this.content) {\n            react_dom_1.unmountComponentAtNode(this.content);\n        }\n        if (this.infoWindow) {\n            this.map.closeInfoWindow();\n            // @ts-ignore\n            this.instance = this.infoWindow = undefined;\n        }\n    };\n    InfoWindow.prototype.initialize = function () {\n        var map = this.map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this.destroy();\n        var options = this.getOptions();\n        var position = this.parsePosition(this.props.position);\n        this.instance = this.infoWindow = new BMapGL.InfoWindow(this.props.text || '', options);\n        map.openInfoWindow(this.infoWindow, position);\n        if (this.props.children !== undefined) {\n            var content = this.content = document.createElement('div');\n            // @ts-ignore\n            react_dom_1.render(this.props.children, content);\n            this.infoWindow.setContent(content);\n        }\n    };\n    InfoWindow.prototype.parsePosition = function (position) {\n        var isMC = this.props.coordType === 'bd09mc';\n        var point;\n        if (position instanceof Array) {\n            point = new BMapGL.Point(position[0], position[1]);\n        }\n        else if (position instanceof BMapGL.Point) {\n            point = position;\n        }\n        else {\n            point = new BMapGL.Point(position.lng, position.lat);\n        }\n        if (isMC) {\n            point = BMapGL.Projection.convertMC2LL(point);\n        }\n        return point;\n    };\n    InfoWindow.prototype.render = function () {\n        return null;\n    };\n    InfoWindow.contextType = Map_1.MapContext;\n    return InfoWindow;\n}(common_1.Component));\n/**\n * defaultProps属性要放在外面，不然生成API文档时，没有默认值\n */\nInfoWindow.defaultProps = {};\n/**\n * 在地图上创建信息窗口，用于展示弹窗信息\n * @visibleName InfoWindow 信息窗口\n */\nexports.default = WrapperHOC_1.default(InfoWindow, eventsMap, methodsMap);\n"]},"metadata":{},"sourceType":"script"}