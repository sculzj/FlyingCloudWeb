{"ast":null,"code":"import \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/avatar/style/css\";\nimport _Avatar from \"antd/es/avatar\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/select/style/css\";\nimport _Select from \"antd/es/select\";\nvar _jsxFileName = \"D:\\\\WebStorm Project\\\\flowingcloud\\\\src\\\\pages\\\\System\\\\Home\\\\Nav\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { DesktopOutlined, SettingOutlined } from \"@ant-design/icons\";\nimport axios from \"axios\";\nimport navStyle from './index.module.css';\nimport Store from '../../../../redux/store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Option\n} = _Select;\nconst {\n  store\n} = Store;\n\nclass Nav extends Component {\n  constructor(props) {\n    super(props);\n\n    this.toSelect = value => {\n      this.state.selects.push(value);\n      this.setState({}, () => {// console.log(this.state);\n      });\n    };\n\n    this.toModifyPwd = () => {\n      this.setState({\n        loading: true\n      }, () => {\n        const data = this.form.getFieldsValue();\n        delete data.configPwd;\n        data.uid = store.getState().userinfo.uid;\n        const timer = setTimeout(() => {\n          this.setState({\n            loading: false\n          }, () => {\n            clearTimeout(timer);\n\n            _Modal.error({\n              title: '错误',\n              content: '网络连接超时，请检查网络配置并重新尝试！'\n            });\n          });\n        }, 15000);\n        axios({\n          url: 'http://localhost:3000/api/initSysPwd',\n          method: 'post',\n          data: data\n        }).then(response => {\n          clearTimeout(timer);\n          this.setState({\n            visible: false,\n            loading: false\n          }, () => {\n            _message.success('密码已修改成功！').then();\n          });\n        }).catch(() => {});\n      });\n    };\n\n    this.state = {\n      visible: false,\n      questions: [],\n      selects: [],\n      loading: false\n    };\n  }\n\n  componentDidMount() {\n    const {\n      init\n    } = store.getState().userinfo;\n\n    if (!init) {\n      axios({\n        url: 'http://localhost:3000/api/questions',\n        method: 'get'\n      }).then(response => {\n        // console.log(response.data);\n        this.setState({\n          visible: true,\n          questions: response.data\n        });\n      }).catch(() => {});\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: navStyle.frame,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: navStyle.left,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: require('../../../../images/logoH.png').default,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: navStyle.right,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: navStyle.user,\n          children: [/*#__PURE__*/_jsxDEV(_Avatar, {\n            src: require('../../../../images/admin.png').default,\n            alt: \"\\u8D44\\u6E90\\u83B7\\u53D6\\u5931\\u8D25\",\n            className: navStyle.icon\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: navStyle.id,\n            children: store.getState().userinfo.uid\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(SettingOutlined, {\n            title: \"\\u5FEB\\u901F\\u8BBE\\u7F6E\",\n            className: navStyle.set\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(DesktopOutlined, {\n            title: \"\\u8FD4\\u56DE\\u4E3B\\u9875\",\n            className: navStyle.set\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n        visible: this.state.visible,\n        title: \"\\u4FEE\\u6539\\u5BC6\\u7801\",\n        footer: null,\n        closable: false,\n        children: /*#__PURE__*/_jsxDEV(_Form, {\n          labelCol: {\n            span: 5\n          },\n          wrapperCol: {\n            span: 17\n          },\n          validateTrigger: \"onBlur\",\n          ref: element => {\n            this.form = element;\n          },\n          onFinish: this.toModifyPwd,\n          children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",\n            name: \"pwd\",\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              type: 'string',\n              pattern: /^[A-Za-z0-9]{7,16}$/,\n              message: '密码为8~16位数字或字母的组合'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input.Password, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u8BF7\\u786E\\u8BA4\\u5BC6\\u7801\",\n            name: \"configPwd\",\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              message: '请再次输入密码！'\n            }, ({\n              getFieldValue\n            }) => ({\n              validator(_, value) {\n                if (!value || getFieldValue('pwd') === value) {\n                  return Promise.resolve();\n                }\n\n                return Promise.reject(new Error('两次输入密码不一致！'));\n              }\n\n            })],\n            children: /*#__PURE__*/_jsxDEV(_Input.Password, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u5BC6\\u4FDD\\u95EE\\u9898\",\n            name: \"question1\",\n            rules: [{\n              required: true,\n              message: '请选择密保问题！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Select, {\n              value: this.state.selects[0] ? this.state.selects[0] : '',\n              onSelect: this.toSelect,\n              children: this.state.questions.map((item, index) => {\n                if (!this.state.selects.includes(item.question)) {\n                  return /*#__PURE__*/_jsxDEV(Option, {\n                    value: item.question,\n                    children: item.question\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 127,\n                    columnNumber: 53\n                  }, this);\n                } else {\n                  return null;\n                }\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u8F93\\u5165\\u7B54\\u6848\",\n            name: \"answer1\",\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              message: '请输入密保问题的答案！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u5BC6\\u4FDD\\u95EE\\u9898\",\n            name: \"question2\",\n            rules: [{\n              required: true,\n              message: '请选择密保问题！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Select, {\n              value: this.state.selects[1] ? this.state.selects[1] : '',\n              onSelect: this.toSelect,\n              children: this.state.questions.map((item, index) => {\n                if (!this.state.selects.includes(item.question)) {\n                  return /*#__PURE__*/_jsxDEV(Option, {\n                    value: item.question,\n                    children: item.question\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 53\n                  }, this);\n                } else {\n                  return null;\n                }\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u8F93\\u5165\\u7B54\\u6848\",\n            name: \"answer2\",\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              message: '请输入密保问题的答案！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u5BC6\\u4FDD\\u95EE\\u9898\",\n            name: \"question3\",\n            rules: [{\n              required: true,\n              message: '请选择密保问题！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Select, {\n              value: this.state.selects[2] ? this.state.selects[2] : '',\n              onSelect: this.toSelect,\n              children: this.state.questions.map((item, index) => {\n                if (!this.state.selects.includes(item.question)) {\n                  return /*#__PURE__*/_jsxDEV(Option, {\n                    value: item.question,\n                    children: item.question\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 179,\n                    columnNumber: 53\n                  }, this);\n                } else {\n                  return null;\n                }\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u8F93\\u5165\\u7B54\\u6848\",\n            name: \"answer3\",\n            hasFeedback: true,\n            rules: [{\n              required: true,\n              message: '请输入密保问题的答案！'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            wrapperCol: {\n              offset: 5,\n              span: 17\n            },\n            children: /*#__PURE__*/_jsxDEV(_Button, {\n              type: \"primary\",\n              htmlType: \"submit\",\n              loading: this.state.loading,\n              block: true,\n              children: \"\\u63D0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\u4EA4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Nav;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/src/pages/System/Home/Nav/index.jsx"],"names":["React","Component","DesktopOutlined","SettingOutlined","axios","navStyle","Store","Option","store","Nav","constructor","props","toSelect","value","state","selects","push","setState","toModifyPwd","loading","data","form","getFieldsValue","configPwd","uid","getState","userinfo","timer","setTimeout","clearTimeout","error","title","content","url","method","then","response","visible","success","catch","questions","componentDidMount","init","render","frame","left","require","default","right","user","icon","id","set","span","element","required","type","pattern","message","getFieldValue","validator","_","Promise","resolve","reject","Error","map","item","index","includes","question","offset"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Avatar, Button, Form, Input, Modal, Select,message} from \"antd\";\r\nimport {DesktopOutlined, SettingOutlined} from \"@ant-design/icons\";\r\nimport axios from \"axios\";\r\n\r\n\r\nimport navStyle from './index.module.css';\r\nimport Store from '../../../../redux/store';\r\n\r\nconst {Option} = Select;\r\nconst {store} = Store;\r\n\r\nclass Nav extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = ({visible: false, questions: [], selects: [], loading: false});\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {init} = store.getState().userinfo;\r\n        if (!init) {\r\n            axios({\r\n                url: 'http://localhost:3000/api/questions',\r\n                method: 'get'\r\n            }).then(response => {\r\n                // console.log(response.data);\r\n                this.setState({visible: true, questions: response.data});\r\n            }).catch(() => {\r\n\r\n            });\r\n        }\r\n    }\r\n\r\n    toSelect = (value) => {\r\n        this.state.selects.push(value);\r\n        this.setState({}, () => {\r\n            // console.log(this.state);\r\n        });\r\n    }\r\n\r\n    toModifyPwd = () => {\r\n        this.setState({loading:true},()=>{\r\n            const data=this.form.getFieldsValue();\r\n            delete data.configPwd;\r\n            data.uid=store.getState().userinfo.uid;\r\n            const timer=setTimeout(()=>{\r\n                this.setState({loading:false},()=>{\r\n                    clearTimeout(timer);\r\n                    Modal.error({\r\n                        title:'错误',\r\n                        content:'网络连接超时，请检查网络配置并重新尝试！'\r\n                    });\r\n                });\r\n            },15000);\r\n            axios({\r\n                url:'http://localhost:3000/api/initSysPwd',\r\n                method:'post',\r\n                data:data\r\n            }).then(response=>{\r\n                clearTimeout(timer);\r\n                this.setState({visible:false,loading:false},()=>{\r\n                    message.success('密码已修改成功！').then();\r\n                })\r\n            }).catch(()=>{\r\n\r\n            })\r\n        })\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div className={navStyle.frame}>\r\n                <div className={navStyle.left}>\r\n                    <img src={require('../../../../images/logoH.png').default} alt=''/>\r\n                </div>\r\n                <div className={navStyle.right}>\r\n                    <div className={navStyle.user}>\r\n                        <Avatar src={require('../../../../images/admin.png').default} alt='资源获取失败'\r\n                                className={navStyle.icon}/>\r\n                        <span className={navStyle.id}>{store.getState().userinfo.uid}</span>\r\n                        <SettingOutlined title='快速设置' className={navStyle.set}/>\r\n                        <DesktopOutlined title='返回主页' className={navStyle.set}/>\r\n                    </div>\r\n                </div>\r\n                <Modal visible={this.state.visible} title='修改密码' footer={null} closable={false}>\r\n                    <Form labelCol={{span: 5}} wrapperCol={{span: 17}} validateTrigger='onBlur' ref={element => {\r\n                        this.form = element\r\n                    }} onFinish={this.toModifyPwd}>\r\n                        <Form.Item label='请输入密码' name='pwd' hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                type: 'string',\r\n                                pattern: /^[A-Za-z0-9]{7,16}$/,\r\n                                message: '密码为8~16位数字或字母的组合'\r\n                            }\r\n                        ]}>\r\n                            <Input.Password/>\r\n                        </Form.Item>\r\n                        <Form.Item label='请确认密码' name='configPwd' hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请再次输入密码！',\r\n                            },\r\n                            ({getFieldValue}) => ({\r\n                                validator(_, value) {\r\n                                    if (!value || getFieldValue('pwd') === value) {\r\n                                        return Promise.resolve();\r\n                                    }\r\n                                    return Promise.reject(new Error('两次输入密码不一致！'));\r\n                                },\r\n                            }),\r\n                        ]}>\r\n                            <Input.Password/>\r\n                        </Form.Item>\r\n                        <Form.Item label='密保问题' name='question1' rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请选择密保问题！'\r\n                            }\r\n                        ]}>\r\n                            <Select value={this.state.selects[0] ? this.state.selects[0] : ''} onSelect={this.toSelect}>\r\n                                {\r\n                                    this.state.questions.map((item, index) => {\r\n                                        if (!this.state.selects.includes(item.question)) {\r\n                                            return (<Option value={item.question} key={index}>{item.question}</Option>);\r\n                                        } else {\r\n                                            return null;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            </Select>\r\n                        </Form.Item>\r\n                        <Form.Item label='输入答案' name='answer1' hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请输入密保问题的答案！'\r\n                            }\r\n                        ]}>\r\n                            <Input/>\r\n                        </Form.Item>\r\n                        <Form.Item label='密保问题' name='question2' rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请选择密保问题！'\r\n                            }\r\n                        ]}>\r\n                            <Select value={this.state.selects[1] ? this.state.selects[1] : ''} onSelect={this.toSelect}>\r\n                                {\r\n                                    this.state.questions.map((item, index) => {\r\n                                        if (!this.state.selects.includes(item.question)) {\r\n                                            return (<Option value={item.question} key={index}>{item.question}</Option>);\r\n                                        } else {\r\n                                            return null;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            </Select>\r\n                        </Form.Item>\r\n                        <Form.Item label='输入答案' name='answer2' hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请输入密保问题的答案！'\r\n                            }\r\n                        ]}>\r\n                            <Input/>\r\n                        </Form.Item>\r\n                        <Form.Item label='密保问题' name='question3' rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请选择密保问题！'\r\n                            }\r\n                        ]}>\r\n                            <Select value={this.state.selects[2] ? this.state.selects[2] : ''} onSelect={this.toSelect}>\r\n                                {\r\n                                    this.state.questions.map((item, index) => {\r\n                                        if (!this.state.selects.includes(item.question)) {\r\n                                            return (<Option value={item.question} key={index}>{item.question}</Option>);\r\n                                        } else {\r\n                                            return null;\r\n                                        }\r\n                                    })\r\n                                }\r\n                            </Select>\r\n                        </Form.Item>\r\n                        <Form.Item label='输入答案' name='answer3' hasFeedback rules={[\r\n                            {\r\n                                required: true,\r\n                                message: '请输入密保问题的答案！'\r\n                            }\r\n                        ]}>\r\n                            <Input/>\r\n                        </Form.Item>\r\n                        <Form.Item wrapperCol={{offset: 5, span: 17}}>\r\n                            <Button type='primary' htmlType='submit' loading={this.state.loading}\r\n                                    block>提&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Modal>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default Nav;\r\n"]},"metadata":{},"sourceType":"module"}