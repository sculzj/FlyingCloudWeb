{"ast":null,"code":"import \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/tree-select/style/css\";\nimport _TreeSelect from \"antd/es/tree-select\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style/css\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/tree/style/css\";\nimport _Tree from \"antd/es/tree\";\nimport \"antd/es/spin/style/css\";\nimport _Spin from \"antd/es/spin\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nvar _jsxFileName = \"D:\\\\WebStorm Project\\\\flowingcloud\\\\src\\\\pages\\\\Admin\\\\WorkSpace\\\\AddGroups\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport axios from \"axios\";\nimport { ApartmentOutlined, DeleteOutlined, EditOutlined, PlusOutlined } from \"@ant-design/icons\";\nimport Store from \"../../../../redux/store\";\nimport addGroupStyle from './index.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  store\n} = Store;\nconst {\n  Column\n} = _Table;\nconst {\n  Search\n} = _Input;\n\nclass AddGroups extends Component {\n  /**\r\n   * 构造器，向服务器请求组织信息\r\n   * @param props\r\n   */\n  constructor(_props) {\n    super(_props);\n\n    this.updateGroupInfo = () => {\n      axios({\n        url: 'http://localhost:3000/api/orgGroup',\n        method: 'post',\n        headers: {\n          authorization: store.getState().token\n        }\n      }).then(response => {\n        const {\n          groups\n        } = response.data; //对象的复制是针对引用地址的复制，需要遍历属性进行深度复制！\n\n        const newGroup = groups.map(item => {\n          const tmp = {};\n          const props = Object.getOwnPropertyNames(item);\n          props.forEach(prop => {\n            tmp[prop] = item[prop];\n          });\n          return tmp;\n        });\n        let treeData = ''; //加工组织数据\n\n        for (let i = 0; i < newGroup.length; i++) {\n          if (newGroup[i].parent) {\n            for (let j = i + 1; j < newGroup.length; j++) {\n              if (newGroup[j].groupCode === newGroup[i].parent) {\n                if (!newGroup[j].children) {\n                  newGroup[j].children = [];\n                }\n\n                let tmp = '';\n\n                if (newGroup[i].children) {\n                  tmp = {\n                    title: newGroup[i].groupName,\n                    key: newGroup[i].groupCode,\n                    children: newGroup[i].children\n                  };\n                } else {\n                  tmp = {\n                    title: newGroup[i].groupName,\n                    key: newGroup[i].groupCode\n                  };\n                }\n\n                newGroup[j].children.push(tmp);\n              }\n            }\n          } else {\n            treeData = [{\n              title: newGroup[i].groupName,\n              key: newGroup[i].groupCode,\n              children: newGroup[i].children ? newGroup[i].children : []\n            }];\n          }\n        }\n\n        this.setState({\n          loading: false,\n          groups: groups,\n          treeData\n        });\n      }).catch();\n    };\n\n    this.hiddenModal = () => {\n      this.setState({\n        option: ''\n      });\n    };\n\n    this.showGroupInfo = selectedKeys => {\n      if (selectedKeys.length === 0) return;\n      const {\n        groups\n      } = this.state;\n      let selected = {};\n\n      for (let i = 0; i < groups.length; i++) {\n        if (groups[i].groupCode === selectedKeys[0]) {\n          selected.groupName = groups[i].groupName;\n          selected.members = groups[i].groupMembers;\n          selected.key = groups[i].groupCode;\n          selected.parentName = '--';\n          selected.parentKey = groups[i].parent;\n\n          for (let j = 0; j < groups.length; j++) {\n            if (groups[j].groupCode === selected.parentKey) {\n              selected.parentName = groups[j].groupName;\n              break;\n            }\n          }\n\n          break;\n        }\n      }\n\n      this.setState({\n        selected\n      });\n    };\n\n    this.showEditGroup = () => {\n      const {\n        selected,\n        groups\n      } = this.state;\n\n      if (groups.length === 1) {\n        const group = {\n          title: groups[0].groupName,\n          value: groups[0].groupCode\n        };\n        this.setState({\n          option: 'edit',\n          enableGroup: [group]\n        });\n        return;\n      } //执行深度复制\n\n\n      const newGroup = groups.map(item => {\n        const tmp = {};\n        const props = Object.getOwnPropertyNames(item);\n        props.forEach(prop => {\n          tmp[prop] = item[prop];\n        });\n        return tmp;\n      }); //过滤返回新数组\n\n      const tmp = newGroup.filter(item => {\n        if (!item.parent) return true;\n        return !item.groupCode.includes(selected.key);\n      });\n\n      for (let i = 0; i < tmp.length; i++) {\n        if (tmp[i].parent) {\n          for (let j = i + 1; j < tmp.length; j++) {\n            if (tmp[j].groupCode === tmp[i].parent) {\n              if (!tmp[j].children) {\n                tmp[j].children = [];\n              }\n\n              if (tmp[i].children) {\n                tmp[j].children.push({\n                  title: tmp[i].groupName,\n                  value: tmp[i].groupCode,\n                  children: tmp[i].children\n                });\n              } else {\n                tmp[j].children.push({\n                  title: tmp[i].groupName,\n                  value: tmp[i].groupCode\n                });\n              }\n            }\n          }\n        } else {\n          const tmpGroup = {};\n          tmpGroup.title = tmp[i].groupName;\n          tmpGroup.value = tmp[i].groupCode;\n\n          if (tmp[i].children) {\n            tmpGroup.children = tmp[i].children;\n          }\n\n          this.setState({\n            option: 'edit',\n            enableGroup: [tmpGroup]\n          }, () => {\n            this.form.setFieldsValue({\n              groupName: this.state.selected.groupName,\n              parent: this.state.selected.parentKey ? this.state.selected.parentKey : this.state.selected.key\n            });\n          });\n        }\n      }\n    };\n\n    this.confirmEditGroup = () => {\n      const {\n        selected\n      } = this.state;\n      const value = this.form.getFieldsValue(true);\n      console.log('编辑的信息：', value, '\\n选中的节点：', selected);\n\n      if (value.groupName === selected.groupName && value.parent === selected.parentKey) {\n        this.setState({\n          option: ''\n        });\n        return;\n      }\n\n      axios({\n        url: 'http://localhost:3000/api/orgGroup',\n        method: 'put',\n        headers: {\n          authorization: store.getState().token\n        },\n        data: value\n      }).then().catch();\n    };\n\n    this.searchGroup = value => {\n      const {\n        groups\n      } = this.state;\n\n      for (let i = 0; i < groups.length; i++) {\n        if (groups[i].groupName.includes(value)) {\n          const selected = {\n            groupName: groups[i].groupName,\n            members: groups[i].groupMembers,\n            key: groups[i].groupCode,\n            parentName: '--',\n            parentKey: groups[i].parent\n          };\n\n          for (let j = 0; j < groups.length; j++) {\n            if (groups[j].groupCode === selected.parentKey) {\n              selected.parentName = groups[j].groupName;\n              break;\n            }\n          }\n\n          this.setState({\n            selected\n          });\n          break;\n        }\n      }\n    };\n\n    this.state = {\n      loading: true,\n      option: '',\n      enableGroup: []\n    };\n    this.updateGroupInfo();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: addGroupStyle.container,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: addGroupStyle.left,\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          placeholder: \"\\u641C\\u7D22\\u7EC4\\u7EC7\",\n          onSearch: this.searchGroup\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '10px'\n          },\n          children: this.state.loading ? /*#__PURE__*/_jsxDEV(_Spin, {\n            tip: \"\\u6B63\\u5728\\u83B7\\u53D6\\u7EC4\\u7EC7\\u4FE1\\u606F\\uFF0C\\u8BF7\\u7A0D\\u5019......\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(_Tree, {\n            treeData: this.state.treeData,\n            icon: /*#__PURE__*/_jsxDEV(ApartmentOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 76\n            }, this),\n            showIcon: true,\n            showLine: {\n              showLeafIcon: false\n            },\n            onSelect: this.showGroupInfo,\n            selectedKeys: this.state.selected ? [this.state.selected.key] : [],\n            expandedKeys: this.state.selected ? [this.state.selected.key] : [],\n            autoExpandParent: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: addGroupStyle.info,\n        children: /*#__PURE__*/_jsxDEV(_Table, {\n          locale: {\n            emptyText: '请选中具体组织后进行操作！'\n          },\n          pagination: {\n            hideOnSinglePage: true\n          },\n          dataSource: this.state.selected ? [this.state.selected] : [],\n          children: [/*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u7EC4\\u7EC7\\u540D\\u79F0\",\n            dataIndex: \"groupName\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'groupName', false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u4E0A\\u7EA7\\u7EC4\\u7EC7\",\n            dataIndex: \"parentName\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'parentName', false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u6210\\u5458\\u6570\\u91CF\",\n            dataIndex: \"members\",\n            align: \"center\",\n            width: \"25%\"\n          }, 'members', false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Column, {\n            title: \"\\u64CD\\u4F5C\",\n            dataIndex: \"option\",\n            align: \"center\",\n            width: \"25%\",\n            render: () => /*#__PURE__*/_jsxDEV(_Space, {\n              size: 15,\n              children: [/*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(EditOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u7F16\\u8F91\\u7EC4\\u7EC7\",\n                onClick: this.showEditGroup\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u589E\\u52A0\\u4E0B\\u7EA7\\u7EC4\\u7EC7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                type: \"link\",\n                icon: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 67\n                }, this),\n                title: \"\\u5220\\u9664\\u7EC4\\u7EC7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n        title: \"\\u7F16\\u8F91\\u7EC4\\u7EC7\",\n        maskClosable: false,\n        visible: this.state.option === 'edit',\n        okText: \"\\u786E\\u8BA4\",\n        cancelText: \"\\u53D6\\u6D88\",\n        onCancel: this.hiddenModal,\n        onOk: this.confirmEditGroup,\n        children: /*#__PURE__*/_jsxDEV(_Form, {\n          ref: element => {\n            this.form = element;\n          },\n          children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u7EC4\\u7EC7\\u540D\\u79F0\",\n            name: \"groupName\",\n            children: /*#__PURE__*/_jsxDEV(_Input, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            label: \"\\u4E0A\\u7EA7\\u7EC4\\u7EC7\",\n            name: \"parent\",\n            children: /*#__PURE__*/_jsxDEV(_TreeSelect, {\n              treeData: this.state.enableGroup,\n              virtual: false\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default AddGroups;","map":{"version":3,"sources":["D:/WebStorm Project/flowingcloud/src/pages/Admin/WorkSpace/AddGroups/index.jsx"],"names":["React","Component","axios","ApartmentOutlined","DeleteOutlined","EditOutlined","PlusOutlined","Store","addGroupStyle","store","Column","Search","AddGroups","constructor","props","updateGroupInfo","url","method","headers","authorization","getState","token","then","response","groups","data","newGroup","map","item","tmp","Object","getOwnPropertyNames","forEach","prop","treeData","i","length","parent","j","groupCode","children","title","groupName","key","push","setState","loading","catch","hiddenModal","option","showGroupInfo","selectedKeys","state","selected","members","groupMembers","parentName","parentKey","showEditGroup","group","value","enableGroup","filter","includes","tmpGroup","form","setFieldsValue","confirmEditGroup","getFieldsValue","console","log","searchGroup","render","container","left","marginTop","showLeafIcon","info","emptyText","hideOnSinglePage","element"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Button, Space, Spin, Table, Tree, Input, Modal, Form, TreeSelect} from \"antd\";\r\nimport axios from \"axios\";\r\nimport {ApartmentOutlined, DeleteOutlined, EditOutlined, PlusOutlined} from \"@ant-design/icons\";\r\nimport Store from \"../../../../redux/store\";\r\nimport addGroupStyle from './index.module.css';\r\n\r\nconst {store} = Store;\r\nconst {Column} = Table;\r\nconst {Search} = Input;\r\n\r\nclass AddGroups extends Component {\r\n\r\n    /**\r\n     * 构造器，向服务器请求组织信息\r\n     * @param props\r\n     */\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {loading: true, option: '', enableGroup: []};\r\n        this.updateGroupInfo();\r\n    }\r\n\r\n    updateGroupInfo=()=>{\r\n        axios({\r\n            url: 'http://localhost:3000/api/orgGroup',\r\n            method: 'post',\r\n            headers: {authorization: store.getState().token}\r\n        }).then(response => {\r\n            const {groups} = response.data;\r\n            //对象的复制是针对引用地址的复制，需要遍历属性进行深度复制！\r\n            const newGroup = groups.map(item => {\r\n                const tmp = {};\r\n                const props = Object.getOwnPropertyNames(item);\r\n                props.forEach((prop) => {\r\n                    tmp[prop] = item[prop];\r\n                });\r\n                return tmp;\r\n            });\r\n            let treeData = '';\r\n\r\n            //加工组织数据\r\n            for (let i = 0; i < newGroup.length; i++) {\r\n                if (newGroup[i].parent) {\r\n                    for (let j = i + 1; j < newGroup.length; j++) {\r\n                        if (newGroup[j].groupCode === newGroup[i].parent) {\r\n                            if (!newGroup[j].children) {\r\n                                newGroup[j].children = [];\r\n                            }\r\n                            let tmp = '';\r\n                            if (newGroup[i].children) {\r\n                                tmp = {\r\n                                    title: newGroup[i].groupName,\r\n                                    key: newGroup[i].groupCode,\r\n                                    children: newGroup[i].children\r\n                                }\r\n                            } else {\r\n                                tmp = {\r\n                                    title: newGroup[i].groupName,\r\n                                    key: newGroup[i].groupCode\r\n                                }\r\n                            }\r\n                            newGroup[j].children.push(tmp);\r\n                        }\r\n                    }\r\n                } else {\r\n                    treeData = [{\r\n                        title: newGroup[i].groupName,\r\n                        key: newGroup[i].groupCode,\r\n                        children: newGroup[i].children ? newGroup[i].children : []\r\n                    }];\r\n                }\r\n            }\r\n            this.setState({loading: false, groups: groups, treeData});\r\n        }).catch();\r\n    }\r\n\r\n    /**\r\n     * 隐藏对话框\r\n     */\r\n    hiddenModal = () => {\r\n        this.setState({option: ''})\r\n    }\r\n\r\n    /**\r\n     * 展示被选中的组织信息\r\n     * @param selectedKeys 被选中的key数组\r\n     */\r\n    showGroupInfo = (selectedKeys) => {\r\n        if (selectedKeys.length === 0)\r\n            return;\r\n        const {groups} = this.state;\r\n        let selected = {};\r\n        for (let i = 0; i < groups.length; i++) {\r\n            if (groups[i].groupCode === selectedKeys[0]) {\r\n                selected.groupName = groups[i].groupName;\r\n                selected.members = groups[i].groupMembers;\r\n                selected.key = groups[i].groupCode;\r\n                selected.parentName = '--';\r\n                selected.parentKey = groups[i].parent;\r\n                for (let j = 0; j < groups.length; j++) {\r\n                    if (groups[j].groupCode === selected.parentKey) {\r\n                        selected.parentName = groups[j].groupName;\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n\r\n        }\r\n        this.setState({selected});\r\n    }\r\n\r\n    /**\r\n     * 展示编辑组织的对话框\r\n     */\r\n    showEditGroup = () => {\r\n        const {selected, groups} = this.state;\r\n        if (groups.length === 1) {\r\n            const group = {title: groups[0].groupName, value: groups[0].groupCode};\r\n            this.setState({option: 'edit', enableGroup: [group]});\r\n            return;\r\n        }\r\n\r\n        //执行深度复制\r\n        const newGroup = groups.map(item => {\r\n            const tmp = {};\r\n            const props = Object.getOwnPropertyNames(item);\r\n            props.forEach((prop) => {\r\n                tmp[prop] = item[prop];\r\n            });\r\n            return tmp;\r\n        });\r\n\r\n        //过滤返回新数组\r\n        const tmp = newGroup.filter(item => {\r\n            if (!item.parent)\r\n                return true;\r\n            return !item.groupCode.includes(selected.key);\r\n        });\r\n        for (let i = 0; i < tmp.length; i++) {\r\n            if (tmp[i].parent) {\r\n                for (let j = i + 1; j < tmp.length; j++) {\r\n                    if (tmp[j].groupCode === tmp[i].parent) {\r\n                        if (!tmp[j].children) {\r\n                            tmp[j].children = [];\r\n                        }\r\n                        if (tmp[i].children) {\r\n                            tmp[j].children.push({\r\n                                title: tmp[i].groupName,\r\n                                value: tmp[i].groupCode,\r\n                                children: tmp[i].children\r\n                            });\r\n                        } else {\r\n                            tmp[j].children.push({\r\n                                title: tmp[i].groupName,\r\n                                value: tmp[i].groupCode\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                const tmpGroup = {};\r\n                tmpGroup.title = tmp[i].groupName;\r\n                tmpGroup.value = tmp[i].groupCode\r\n                if (tmp[i].children) {\r\n                    tmpGroup.children = tmp[i].children;\r\n                }\r\n                this.setState({\r\n                    option: 'edit',\r\n                    enableGroup: [tmpGroup]\r\n                }, () => {\r\n                    this.form.setFieldsValue({\r\n                        groupName: this.state.selected.groupName,\r\n                        parent: this.state.selected.parentKey ? this.state.selected.parentKey : this.state.selected.key\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 提交编辑后的组织信息\r\n     */\r\n    confirmEditGroup = () => {\r\n        const {selected}=this.state;\r\n        const value = this.form.getFieldsValue(true);\r\n        console.log('编辑的信息：',value,'\\n选中的节点：',selected);\r\n        if (value.groupName===selected.groupName&&value.parent===selected.parentKey){\r\n            this.setState({option:''});\r\n            return;\r\n        }\r\n        axios({\r\n            url: 'http://localhost:3000/api/orgGroup',\r\n            method: 'put',\r\n            headers: {authorization: store.getState().token},\r\n            data:value\r\n        }).then().catch();\r\n    }\r\n\r\n    searchGroup = (value) => {\r\n        const {groups} = this.state;\r\n        for (let i = 0; i < groups.length; i++) {\r\n            if (groups[i].groupName.includes(value)) {\r\n                const selected = {\r\n                    groupName: groups[i].groupName,\r\n                    members: groups[i].groupMembers,\r\n                    key: groups[i].groupCode,\r\n                    parentName: '--',\r\n                    parentKey: groups[i].parent,\r\n                };\r\n                for (let j = 0; j < groups.length; j++) {\r\n                    if (groups[j].groupCode === selected.parentKey) {\r\n                        selected.parentName = groups[j].groupName;\r\n                        break;\r\n                    }\r\n                }\r\n                this.setState({selected});\r\n                break;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={addGroupStyle.container}>\r\n                <div className={addGroupStyle.left}>\r\n                    <Search placeholder='搜索组织' onSearch={this.searchGroup}/>\r\n                    <div style={{marginTop: '10px'}}>\r\n                        {\r\n                            this.state.loading ?\r\n                                <Spin tip='正在获取组织信息，请稍候......'/> :\r\n                                <Tree treeData={this.state.treeData} icon={<ApartmentOutlined/>} showIcon={true}\r\n                                      showLine={{showLeafIcon: false}} onSelect={this.showGroupInfo}\r\n                                      selectedKeys={this.state.selected ? [this.state.selected.key] : []}\r\n                                      expandedKeys={this.state.selected ? [this.state.selected.key] : []}\r\n                                      autoExpandParent={true}/>\r\n                        }\r\n                    </div>\r\n                </div>\r\n                <div className={addGroupStyle.info}>\r\n                    <Table locale={{emptyText: '请选中具体组织后进行操作！'}} pagination={{hideOnSinglePage: true}}\r\n                           dataSource={this.state.selected ? [this.state.selected] : []}>\r\n                        <Column title='组织名称' dataIndex='groupName' key='groupName' align='center' width='25%'/>\r\n                        <Column title='上级组织' dataIndex='parentName' key='parentName' align='center' width='25%'/>\r\n                        <Column title='成员数量' dataIndex='members' key='members' align='center' width='25%'/>\r\n                        <Column title='操作' dataIndex='option' align='center' width='25%'\r\n                                render={() => (\r\n                                    <Space size={15}>\r\n                                        <Button type='link' icon={<EditOutlined/>} title='编辑组织'\r\n                                                onClick={this.showEditGroup}/>\r\n                                        <Button type='link' icon={<PlusOutlined/>} title='增加下级组织'/>\r\n                                        <Button type='link' icon={<DeleteOutlined/>} title='删除组织'/>\r\n                                    </Space>\r\n                                )}/>\r\n                    </Table>\r\n                </div>\r\n                {/*Modal初始状态为不可见，未渲染，状态可见后才执行渲染，创建Form*/}\r\n                <Modal title='编辑组织' maskClosable={false} visible={this.state.option === 'edit'} okText='确认'\r\n                       cancelText='取消' onCancel={this.hiddenModal} onOk={this.confirmEditGroup}>\r\n                    <Form ref={element => {\r\n                        this.form = element;\r\n                    }}>\r\n                        <Form.Item label='组织名称' name='groupName'>\r\n                            <Input/>\r\n                        </Form.Item>\r\n                        <Form.Item label='上级组织' name='parent'>\r\n                            <TreeSelect treeData={this.state.enableGroup} virtual={false}/>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AddGroups;\r\n"]},"metadata":{},"sourceType":"module"}